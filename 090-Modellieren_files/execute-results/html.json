{
  "hash": "71e56fd432f2400677cbec1c028052f3",
  "result": {
    "markdown": "# Auswerten: Modellieren\n\n\n\n\n\n::: {.cell hash='090-Modellieren_cache/html/unnamed-chunk-2_e7f98061d10455954c4b35e81ad7d042'}\n\n:::\n\n\n## Lernsteuerung\n\n\n### Lernziele\n\n\n- Sie k√∂nnen die Modellformel Ihrer Forschungsfrage nennen.\n- Sie k√∂nnen Ihre Modellformel (korrekt) in R spezifizieren.\n- Sie k√∂nnen Ihr Modell in R berechnen und die Ausgabe interpretieren.\n- Sie k√∂nnen die G√ºltigkeit bzw. die Grenzen der Aussagen Ihres Modells einsch√§tzen.\n\n\n### Ben√∂tigte R-Pakete\n\n\n\n::: {.cell hash='090-Modellieren_cache/html/unnamed-chunk-3_a39bcbe8933acd32de610ad88338deec'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(easystats)\nlibrary(ggstatsplot)\nlibrary(rstanarm)\n```\n:::\n\n\n\n\n### Position im Lernpfad\n\nSie befinden sich im Abschnitt \"Auswerten\" in @fig-ueberblick.\nBehalten Sie Ihren Fortschritt im Projektplan im Blick, s. @fig-projektplan.\n\n\n### Grundlagen der statischen Modellierung\n\n\nDie Grundlagen der statistischen Modellierung mit einem Fokus auf Bayes-Modellen k√∂nnen Sie [hier](https://start-bayes.netlify.app/) nachlesen.\n\n\n\n### √úberblick\n\nIn diesem Kapitel sind die grundlegenden Verfahren zur Modellierung und inferenzstatistischen Absicherung Ihrer Forschungsfragen angerissen.\nDie Darstellung zielt auf ein \"so-geht's\" ab, nicht auf eine vollst√§ndige Darstellung aller Auswertungsm√∂glichkeiten.\n\n## 1 between-Variable\n\n### Design\n\n@sauer_effect_2023 untersuchten in einer Querschnittsstudie den Effekt des Wirkstoff *Bringnixtin* auf die fluide Intelligenz. Die Autoren nahmen an, dass der Wirkstoff den individuellen Wert der abh√§ngigen Variable erh√∂hen w√ºrde.\n\n\nDer Ablauf (aus Sicht der Probandis) ist in @fig-bringtnixtin-flow dargestellt.\n`Intro` fasst die Begr√º√üung der Probandis inkl. Informed Consent sowie Erfassung von soziodemografischen Variablen zusammen.\n`g.0` und `g.1` sind die zwei Stufen der UV (*g* wie Gruppe), wobei `g.0` die Kontrollgruppe kodiert (Placebo, also Zuckerpille, kein Wirkstoff,) und `g.1` die *zweite* Stufe, d.h. die Experimentalgruppe (hohe Dosis Bringtnixtin).\n`y2` ist die Messung der AV (d.h. nach Gabe von Bringtnixtin), d.h. ein Ma√ü der fluiden Intelligenz.\n`outro` meint die Verabschiedung der Probanden sowie einige Fragen zu Compliance.\n\n\nDie Hypothese lautet: $\\mu_{g.2} > \\mu_{g.1}$. \n\nIn Worten:\n\n>  Wir erwarten, dass der Mittelwert der Experimentalgruppe h√∂her ist als der Mittelwert der Kontrollgruppe.\n\n\n\n\n```{mermaid}\n%%| label: fig-bringtnixtin-flow\n%%| fig-cap: Ablaufdiagramm der Bringtnixtin-Studie\n\nflowchart LR\n  Intro --> g.0\n  Intro --> g.1\n  g.0 --> y2\n  g.1 --> y2\n  y2 --> outro\n```\n\n\nDer DAG des Experiments ist in @fig-bringtnixtin-dag dargestellt.\n\n\n\n::: {.cell fig.asp='0.5' hash='090-Modellieren_cache/html/fig-bringtnixtin-dag_bdecbf26d2af20ce2c5557d6e41c7119'}\n::: {.cell-output-display}\n![DAG f√ºr der Bringtnixtin-Studie](090-Modellieren_files/figure-html/fig-bringtnixtin-dag-1.png){#fig-bringtnixtin-dag width=100%}\n:::\n:::\n\n\n\n:::{.callout-note}\nIm DAG  @fig-bringtnixtin-dag ist `u` als Ursache von `y2` angegeben.\n`u` steht hier stellvertretend f√ºr alle weiteren Ursachen von `y2`, vermutlich sind das sehr viele.\nAber sie interessieren uns nicht.\nDaher k√∂nnen Sie `u` auch aus dem DAG weglassen.\nStreng genommen sollten Sie es sogar weglassen,\ndenn im DAG zeigt man nur diejenigen Variablen, die f√ºr Ihre Hypothese von Belang sind. \nDa `u` keine Verbindung zum Pfad `g -> y2` hat,\nbrauchen wir es f√ºr die Bestimmung des Kausaleffekts nicht zu ber√ºcksichtigen.$\\square$\n:::\n\n\n::: {.cell hash='090-Modellieren_cache/html/d_bringtnixtin_6177c585feb2c72e5e9f591908d9c4f7'}\n\n:::\n\n\n\nDie Daten dieses Experiments sind hier zu beziehen:\n\n\n::: {.cell hash='090-Modellieren_cache/html/unnamed-chunk-6_674e4639b5274e19e63191c097a89298'}\n\n```{.r .cell-code}\nd_bringtnixtin_path <- \"https://raw.githubusercontent.com/sebastiansauer/fopra/main/data/d_bringtnixtin.csv\"\nd_bringtnixtin <- read_csv(d_bringtnixtin_path)\n```\n:::\n\n{{< downloadthis data/d_bringtnixtin.csv >}}\n\n\n\nDie Autoren der Studie geben an, dass die Daten in z-Einheiten skaliert sind.\n\n\n### Deskriptive Analyse\n\n\n\n::: {.cell hash='090-Modellieren_cache/html/unnamed-chunk-7_6053cfaafe31004756e2af9af8f6a7d5'}\n\n```{.r .cell-code}\nd_bringtnixtin %>% \n  group_by(g) %>% \n  summarise(iq_mw = mean(y2),\n            iq_sd = sd(y2)) \n```\n:::\n\n::: {#tbl-bringtnixtin-desk .cell tbl-cap='Mittlere fluide Intelligenz nach der Bringtnixtin-Intervention in Abh√§ngigkeit der Gruppe' hash='090-Modellieren_cache/html/tbl-bringtnixtin-desk_eccf3956098df77e4e10104b82b4b961'}\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"g\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"iq_mw\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"iq_sd\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0\",\"2\":\"0.1917379\",\"3\":\"1.337211\"},{\"1\":\"1\",\"2\":\"-0.5722050\",\"3\":\"1.110908\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nDie deskriptiven Kennwerte sind in @fig-bringtnixtin-desk dargestellt.\nDas sieht nicht gerade nach einem gro√üen Effekt aus ...^[Die Mittelwerte der beiden Gruppen sind praktisch identisch.]\n\n\n\n::: {.cell hash='090-Modellieren_cache/html/fig-bringtnixtin-desk_e62d207e0507429f095db8cb6c1c7919'}\n\n```{.r .cell-code}\nggbetweenstats(\n  data = d_bringtnixtin,\n  x = g,\n  y = y2,\n  results.subtitle = FALSE  # keine Statistiken zeigen\n)\n```\n\n::: {.cell-output-display}\n![Fluide Intelligenz (y2) nach der Bringtnixtin-Intervention. g=0: Kontrollgruppe (Placebo), g=1: Experimentalgruppe (hohe Dosis)](090-Modellieren_files/figure-html/fig-bringtnixtin-desk-1.png){#fig-bringtnixtin-desk width=672}\n:::\n:::\n\n\n\n\n### Modellierung\n\n\nWir berechnen ein lineares Modell mit der Modellformel `y2 ~ g`. \nDie Ergebnisse sind in @tbl-m1-params zu sehen.\n\n\n::: {#tbl-m1-params .cell tbl-cap='Parameter des Modells m_bringtnixtin' hash='090-Modellieren_cache/html/tbl-m1-params_7a79a4cbacff5c22af2a6f2a84e1127f'}\n\n```{.r .cell-code}\nm_bringtnixtin <- stan_glm(y2 ~ g, data = d_bringtnixtin, refresh = 0, seed = 42)\nparameters(m_bringtnixtin)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Parameter\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Median\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_low\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_high\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"pd\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Rhat\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"ESS\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Prior_Distribution\"],\"name\":[9],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Prior_Location\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Prior_Scale\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"(Intercept)\",\"2\":\"0.1867018\",\"3\":\"0.95\",\"4\":\"-0.3718685\",\"5\":\"0.76016256\",\"6\":\"0.75275\",\"7\":\"0.9999175\",\"8\":\"3259.147\",\"9\":\"normal\",\"10\":\"-0.1902336\",\"11\":\"3.183966\"},{\"1\":\"g\",\"2\":\"-0.7718971\",\"3\":\"0.95\",\"4\":\"-1.5582385\",\"5\":\"0.02449839\",\"6\":\"0.97075\",\"7\":\"1.0003956\",\"8\":\"3334.573\",\"9\":\"normal\",\"10\":\"0.0000000\",\"11\":\"6.287828\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nDie Punkt- und Intervallsch√§tzer (95%-ETI) sind in @fig-m1-params dargestellt.\n\n\n::: {.cell hash='090-Modellieren_cache/html/fig-m1-params_aed519740707887e7501a7d308f78776'}\n\n```{.r .cell-code}\nparameters(m_bringtnixtin) %>% plot(show_intercept = TRUE)\n```\n\n::: {.cell-output-display}\n![Parameter des Modells `m_bringtnixtin (95%-ETI)`](090-Modellieren_files/figure-html/fig-m1-params-1.png){#fig-m1-params width=672}\n:::\n:::\n\n::: {.cell hash='090-Modellieren_cache/html/unnamed-chunk-12_201db50f0d522393cc8ff1df403be999'}\n\n:::\n\n\n\n\nDer Gruppenunterschied wird auf 0.19, -0.77 gesch√§tzt;\ndas ist der Punktsch√§tzer der UV `g`.\nDie Grenzen eines 95%-CI f√ºr die UV liegen bei -1.55 bzw. -0.01.\nDieser Bereich enth√§lt die Null, vgl. @fig-m1-params.\nDaher kann nicht ausgeschlossen werden,\ndass Bringtnixtin nix bringt.\n\n>   üë®‚Äçüè´ Frau Professor Lustig, wie kann das sein, dass sich die Hypothese nicht best√§tigt?\n\n>   üë©‚Äçüè´ Herr Professor Sauer, auch ein negatives Ergebnis bringt die Wissenschaft weiter.\n\n\nTesten wir eine Nullhypothese mit dem ROPE-Verfahren: `rope(m_bringtnixtin)`, s. @tbl-m1-rope und @fig-m1-rope.\n\n\n\n\n\n::: {#tbl-m1-rope .cell tbl-cap='ROPE f√ºr Modell m_bringtnixtin' hash='090-Modellieren_cache/html/tbl-m1-rope_a37a57204929b3545993f32ff47a3d03'}\n::: {.cell-output-display}\n|Parameter   |  CI | ROPE_low| ROPE_high| ROPE_Percentage| Effects|  Component |\n|:-----------|:----|--------:|---------:|---------------:|-------:|:-----------|\n|(Intercept) |0.95 |    -0.13|      0.13|            0.29|   fixed|conditional |\n|g           |0.95 |    -0.13|      0.13|            0.03|   fixed|conditional |\n:::\n:::\n\n::: {.cell hash='090-Modellieren_cache/html/fig-m1-rope_e44bb2e2cf0776f3ae09025fe0afd99f'}\n\n```{.r .cell-code}\nplot(rope(m_bringtnixtin)) + scale_fill_okabeito()\n```\n\n::: {.cell-output-display}\n![ROPE f√ºr Modell `m_bringtnixtin`](090-Modellieren_files/figure-html/fig-m1-rope-1.png){#fig-m1-rope width=672}\n:::\n:::\n\n\n[`scale_fill_okabeito()`](https://malcolmbarrett.github.io/ggokabeito/reference/scale_okabe_ito.html) ist eine Funktion aus dem Metapaket `{easystats}`.^[Genauer gesagt aus dem Paket `{see}`, das ein Teil des Metapakets `{easystasts}` ist.]\nDas [Farbschema nach Okabe und Ito](https://jfly.uni-koeln.de/color/) ist gut geeignet, um nominal skalierte Farben zu kodieren (s. Details [hier](https://data-se.netlify.app/2023/06/30/farbpaletten/)).\n\nDa sich das 95%-CI mit dem ROPE √ºberlappt, kann die Nullhypothese bzw. das ROPE (kein praktisch bedeutsamer Effekt) *nicht* ausgeschlossen werden.\n\n\n::: {.cell hash='090-Modellieren_cache/html/unnamed-chunk-15_a399b9e6c2fe282ba7019c6fc7eea631'}\n\n:::\n\n\n\n\nEine vergleichbare Information bietet uns die Kennzahl `pd`, s. @tbl-m1-params.\nDer Wert f√ºr `g` liegt bei ca. 0.97.\n\n:::{.callout-note}\n`pd` gibt die Wahrscheinlichkeit (laut Modell) an, dass der Effekt in der Population negativ bzw. positiv ist (d.h. gleich dem Vorzeichen des Punktsch√§tzers; in diesem Fall negativ).$\\square$\n:::\n\n<!-- Das Modell ist sich nicht sehr sicher, in welche Richtung der Effekt von Bringtnixtin zeigt. -->\n<!-- Das Modell neigt eher zur Meinung, dass der Effekt von `g` (in der Population) *negativ* ist. Ganz sicher ist sich aber das Modell nicht. -->\nDas Modell ist sicher ziemlich sicher, dass der Effekt von `g` (in der Population) *negativ* ist. \n\n>   üë®‚Äçüè´ Frau Professor Lustig, oh je!\n\n>   üë©‚Äçüè´ Herr Professor Sauer, wir m√ºssen erst einmal in Ruhe die Studie replizieren. Eine Schwalbe macht noch keinen Fr√ºhling.\n\n\n\n## Vorher-Nachher-Messung, 1 between-Variable\n\n\n### Design\n\n@sauer_effect_2023 fiel auf, dass es sinnvoller ist, zuerst die AV mittels eines Vortests zu messen, dann die Intervention anzuwenden, und dann nachher (Posttest) die AV wieder zu messen.\nDaher haben sie sowohl vor der Intervention (`t1`) als auch nach der Intervention (Gabe von Bringtnixtin), `t2`, die AV (`y`, Behaltensleistung) gemessen.\n\n\n:::{.callout-note}\nEine Vorher-Nachher-Messung hat den Verteil, dass sie - im Gegensatz zur Nur-Nachher-Messung - unterschiedliche Ausgangswerte in der AV herausrechnet. \nBei gro√üen Gruppen wird sich bei einer randomisierten Zuweisung zu den Gruppen der Ausgangswert der AV angleichen. Bei nicht so gro√üen Gruppen kann aber auch bei Randomisierung ein - mitunter erheblicher - Unterschied zwischen den Gruppen verbleiben.\nFindet man bei der Post-Messung einen Effekt, so kann es sein, dass dieser nicht auf die Intervention beruht, sondern auf die von vornherein vorhandenen Unterschieden zwischen den Gruppen.$\\square$\n:::\n\n\n:::{#callout-note}\nVergleicht man die Delta-Werte zwischen zwei Gruppen,\nberechnet man die Differenz zwischen den Gruppen der Delta-Werte.\nMan spricht daher von einer *Difference-in-Difference-Analyse*.$\\square$\n:::\n\n\n\n@fig-bringtnixtin-flow2 zeigt den Ablaufplan dieses Experiments.\n\n\n```{mermaid}\n%%| label: fig-bringtnixtin-flow2\n%%| fig-cap: Ablaufdiagramm der Bringtnixtin-Studie\n\nflowchart LR\n  Intro --> y1\n  y1 --> g.1\n  y1 --> g.2\n  g.1 --> y2\n  g.2 --> y2\n  y2 --> outro\n```\n\n\nDAG des Experiments ist in @fig-bringtnixtin-dag2 dargestellt.\n\n\n\n::: {.cell fig.asp='0.5' hash='090-Modellieren_cache/html/fig-bringtnixtin-dag2_17214bbc9e3c412c4cae63da7b261809'}\n::: {.cell-output-display}\n![DAG f√ºr der Bringtnixtin-Studie](090-Modellieren_files/figure-html/fig-bringtnixtin-dag2-1.png){#fig-bringtnixtin-dag2 width=100%}\n:::\n:::\n\n\n### Deskriptive Analyse\n\nEine einfache (und sinnvolle) Art, solche Studiendesigns auszuwerten ist die Bildung einer Differenz-Variable^[auch Delta-Veriable genannt].\nDiese Differenzvariable gibt die Ver√§nderung der fluiden Intelligenz durch die Intervention an.\nAnders gesagt: Die Differenz ist die IQ-Wert einer Person *nach* der Intervention minus dem IQ-Wert *vor* der Intervention: $d = y_2 - y_1$:\n\n\n::: {.cell hash='090-Modellieren_cache/html/unnamed-chunk-18_7b359d33c69400cd6f79642a1254c5a0'}\n\n```{.r .cell-code}\nd_bringtnixtin <-\n  d_bringtnixtin %>% \n  mutate(d = y2 - y1)\n```\n:::\n\n\nSchauen wir uns die ersten paar d-Werte f√ºr jede der beiden Gruppen (`g=0`  bzw. `g=1`) an:\n\n\n::: {.cell hash='090-Modellieren_cache/html/unnamed-chunk-19_29eb672b8df4195a7adf4fd6e1425fc7'}\n::: {.cell-output-display}\n|id |g |    y1|    y2|     d|\n|:--|:-|-----:|-----:|-----:|\n|1  |0 |  1.37|  1.41|  0.04|\n|2  |0 | -0.56| -0.64| -0.07|\n|3  |0 |  0.36|  0.51|  0.15|\n|21 |1 | -0.31| -0.71| -0.41|\n|22 |1 | -1.78| -2.08| -0.30|\n|23 |1 | -0.17| -0.39| -0.22|\n:::\n:::\n\n\n\n<!-- Puh! Das Bringtnixtin scheint die IQ zu *verringern*, zumindest in einigen F√§llen. -->\n\n\n\n\nVielleicht ist es anschaulicher, wenn wir die Gruppe `0` in den Text `Kontrollgruppe` umbenennen und `1` in `Experimentalgruppe`:\n\n\n\n::: {.cell hash='090-Modellieren_cache/html/unnamed-chunk-20_0e161d9adfa86d4a1a109f1a45a78f23'}\n\n```{.r .cell-code}\nd_bringtnixtin <-\n  d_bringtnixtin %>% \n  mutate(g_text =\n           case_when(g == 0 ~ \"Kontrollgruppe\",\n                     g == 1 ~ \"Experimentalgruppe\"))\n```\n:::\n\n\nHier sind die Mittelwerte f√ºr jede der beiden Gruppen:\n\n\n\n\n::: {.cell hash='090-Modellieren_cache/html/unnamed-chunk-21_852343409b51509a6ceb351b5facc557'}\n\n```{.r .cell-code}\nd_bringtnixtin %>% \n  group_by(g_text) %>%\n  summarise(d = mean(d))\n```\n:::\n\n::: {.cell tbl-cap='Mittelwerte der Ver√§nderung der Behaltensleistung nach Gruppe' hash='090-Modellieren_cache/html/d-bringtnixtin-mean_29063f6c21497852e0ddbd3c5d1c933a'}\n::: {.cell-output-display}\n|g_text             |         d|\n|:------------------|---------:|\n|Experimentalgruppe |     -0.30|\n|Kontrollgruppe     | -1.82e-04|\n:::\n:::\n\n\nDie deskiptiven Kennwerte sind in @fig-bringtnixtin-desk2 dargestellt.\n\n\n\n::: {.cell hash='090-Modellieren_cache/html/fig-bringtnixtin-desk2_28c1bb1805321824e6af8c6137aee83a'}\n\n```{.r .cell-code}\nggbetweenstats(\n  data = d_bringtnixtin,\n  x = g_text,\n  y = d,\n  results.subtitle = FALSE  # keine Statistiken zeigen\n)\n```\n\n::: {.cell-output-display}\n![Ver√§nderung der fluiden Intelligenz (d) in Abh√§ngigkeit der Gruppe; g=0: Kontrollgruppe (Placebo), g=1: Experimentalgruppe (hohe Dosis)](090-Modellieren_files/figure-html/fig-bringtnixtin-desk2-1.png){#fig-bringtnixtin-desk2 width=672}\n:::\n:::\n\n\n\n\n### Modellierung\n\nWir modellieren (in `m_bringtnixtin2`) jetzt die Ver√§nderung `d = y2 - y1` als AV; UV ist wieder `g`, s. @tbl-m-bringtnixtin2-params.\n\n\n::: {.cell hash='090-Modellieren_cache/html/unnamed-chunk-24_3b082659f4c3b71e2785412316dd37ba'}\n\n```{.r .cell-code}\nm_bringtnixtin2 <- stan_glm(d ~ g, data = d_bringtnixtin, refresh = 0, seed = 42)\nparameters(m_bringtnixtin2)\n```\n:::\n\n::: {#tbl-m-bringtnixtin2-params .cell tbl-cap='Parameter von `m_bringtnixtin2`' hash='090-Modellieren_cache/html/tbl-m-bringtnixtin2-params_5b72a67a1bdf1c68307a79c7c7f4289d'}\n::: {.cell-output-display}\n|Parameter   |    Median |         95% CI |     pd |  Rhat |     ESS |                  Prior |\n|:-----------|:---------:|:--------------:|:------:|:-----:|:-------:|:----------------------:|\n|(Intercept) | -4.38e-04 |  (-0.08, 0.08) | 50.58% | 1.001 | 3611.00 | Normal (-0.15 +- 0.59) |\n|g           |     -0.30 | (-0.42, -0.18) |   100% | 1.000 | 3508.00 |  Normal (0.00 +- 1.17) |\n:::\n:::\n\n\n\n@fig-bringtnixtin2-params zeigt die Parameterwerte f√ºr `m_bringtnixtin2`,\n\n\n::: {.cell hash='090-Modellieren_cache/html/fig-bringtnixtin2-params_ab1453b1aca6844df9add80ca225b5d3'}\n\n```{.r .cell-code}\nplot(parameters(m_bringtnixtin2))\n```\n\n::: {.cell-output-display}\n![Parameterwerte von m_bringtnixtin2 (Intercept ist nicht dargestellt), 95%-ETI; die Null ist nicht enthalten, der Mittelwert ist negativ.](090-Modellieren_files/figure-html/fig-bringtnixtin2-params-1.png){#fig-bringtnixtin2-params width=672}\n:::\n:::\n\n\n\nWie man den Parameterwerten entnehmen kann,\nist sich das Modell sehr sicher, dass der Effekt von Bringtnixtin *negativ* ist.\n<!-- ist sich das Modell nicht sicher, welche Richtung der Effekt von Bringtnixtin hat. -->\n\n\n## Beobachtungsstudien\n\nG√§ngige Forschungsfragen f√ºr Beobachtungsstudien sind [hier](https://start-bayes.netlify.app/https://start-bayes.netlify.app/1000-metrische-av) erl√§utert.\n\n\n\n\n\n\n## 1 within-Variable\n\n\nEine Studie mit Vorher-Nachher-Messung setzt ein Within-Design um.\n\n\n:::{#exm-within1}\n### Statisches Diagramm vs. animiertes Diagramm\nEin Forschungsteam untersuch den Effekt der UV *Visualisierungsart* `V` (mit den zwei Stufen `V.1` *animiert* und `V.2` *statisch*) auf die Behaltensleistung (`y`) von Probanden.\nNach jeder Bedingung wird die Behaltensleistung gemessen (anhand von 10 Wissensfragen, die jeweils als \"richtig\" oder \"falsch\" bewertet wurden), mit `y1` nach `V.1` und `y2` f√ºr `V.2`.$\\square$\n:::\n\n\n\n### Design\n\n\nForschungsfrage:\n\n>    Hat die Diagrammart einen Einfluss auf die Behaltensleistung? Anders gesagt: Unterscheiden sich die Diagrammarten in ihrem Einfluss auf die mittlere Behaltensleistung?\n\n\nDie zugeh√∂rige statistische Hypothese kann man so formulieren: $\\bar{d} \\ne 0$, wobei $d = y_1 - y_2$.\n$d$ misst also den Unterschied der Behaltensleistung von animierten und statischen Diagrammen,\nwobei positive Werte zugunsten von statischen Diagrammen sprechen.\n\nDie Modellformel lautet: `d ~ 1`,\ndas ist ein *Intercept-Modell*, also ein Modell ohne Pr√§diktor. \nUns interessiert, ob die Variable `d` im Mittelwert ungleich Null ist oder positiv (zugunsten statischer Diagramme) oder negativ (Behaltensleistung h√∂her bei animierten Diagrammen).\n\nDer Ablauf der Studie (aus Sicht der Probandis) ist in @fig-diagrammart-flow dargestellt.\n\n\n```{mermaid}\n%%| label: fig-diagrammart-flow\n%%| fig-cap: \"Ablauf der Studie zur Behaltensleistung y2 in Abh√§ngigkeit der Visualisierungsart V (Within-Variable)\"\nflowchart LR\n  V.1 --> y1 --> V.2 --> y2\n```\n\n\n\n\n\nDer DAG des Experiments ist in @fig-diagrammarten-dag dargestellt.\n\n\n\n::: {.cell fig.asp='0.5' hash='090-Modellieren_cache/html/fig-diagrammarten-dag_48d88be7f91ca8410565a37cf18113ad'}\n::: {.cell-output-display}\n![DAG f√ºr die Studie zur Behaltensleistung y2 in Abh√§ngigkeit des Visualiserungstyp V](090-Modellieren_files/figure-html/fig-diagrammarten-dag-1.png){#fig-diagrammarten-dag width=100%}\n:::\n:::\n\n\n### Deskriptive Analyse\n\nHier sind einige Spieldaten:\n\n\n::: {.cell hash='090-Modellieren_cache/html/unnamed-chunk-29_e86eb29755c7c813b585c1bad5048db9'}\n\n```{.r .cell-code}\nd_within <- \n  read_csv(\"https://raw.githubusercontent.com/sebastiansauer/Lehre/main/data/withindesign.csv\") %>% \n  select(-c(y3, g)) # diese beiden Variablen ignorieren wir f√ºr den Augenblick\n\nhead(d_within)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"id\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y1\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y2\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"7\",\"3\":\"8\"},{\"1\":\"2\",\"2\":\"7\",\"3\":\"7\"},{\"1\":\"3\",\"2\":\"4\",\"3\":\"9\"},{\"1\":\"4\",\"2\":\"7\",\"3\":\"4\"},{\"1\":\"5\",\"2\":\"6\",\"3\":\"7\"},{\"1\":\"6\",\"2\":\"5\",\"3\":\"4\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n{{< downloadthis data/withindesign.csv >}}\n\n\n\n\n\n\nWir berechnen `d`, was die zentrale Variable der Forschungsfrage ist.\n\n\n\n::: {.cell hash='090-Modellieren_cache/html/unnamed-chunk-30_9ac3f8c1aef6f469a52746b97c1b0664'}\n\n```{.r .cell-code}\nd_within <-\n  d_within %>% \n  mutate(d = y1 - y2)\n\nhead(d_within)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"id\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y1\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y2\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"d\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"7\",\"3\":\"8\",\"4\":\"-1\"},{\"1\":\"2\",\"2\":\"7\",\"3\":\"7\",\"4\":\"0\"},{\"1\":\"3\",\"2\":\"4\",\"3\":\"9\",\"4\":\"-5\"},{\"1\":\"4\",\"2\":\"7\",\"3\":\"4\",\"4\":\"3\"},{\"1\":\"5\",\"2\":\"6\",\"3\":\"7\",\"4\":\"-1\"},{\"1\":\"6\",\"2\":\"5\",\"3\":\"4\",\"4\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nEs klingt trivial, aber man muss sich ein Bild von den Daten (hier `d`) machen, wortw√∂rtlich, s. @fig-d1.\n\n\n::: {.cell hash='090-Modellieren_cache/html/fig-d1_869aa16ac60da6f9a69cd98c798fc3ff'}\n\n```{.r .cell-code}\ngghistostats(d_within,\n             x = d,\n             results.subtitle = FALSE  # verzichte auf zus√§tzliche Statistiken\n             )\n```\n\n::: {.cell-output-display}\n![Die Verteilung von d: Die Behaltensleistung ist im Mittel besser f√ºr animierte Diagramme (in diesen Daten)](090-Modellieren_files/figure-html/fig-d1-1.png){#fig-d1 width=672}\n:::\n:::\n\n\nDa `d` im Mittel negativ ist, ist der Mittelwert von `y2` (animiert) h√∂her als der von `y1` (statisch).\n\nLassen wir uns die deskriptiven Kennwerte ausgeben, s. @tbl-d1-desk.\n\n\n\n::: {.cell hash='090-Modellieren_cache/html/unnamed-chunk-32_c20013d70595e0934d7784de41949a1d'}\n\n```{.r .cell-code}\nd_within %>% \n  describe_distribution(d)\n```\n:::\n\n::: {#tbl-d1-desk .cell tbl-cap='Statistiken f√ºr `d`' hash='090-Modellieren_cache/html/tbl-d1-desk_5d6161f0ef2dc4df9a16030a3b9d1a23'}\n::: {.cell-output-display}\n|Variable |  Mean |   SD | IQR |         Range | Skewness | Kurtosis |  n | n_Missing |\n|:--------|:-----:|:----:|:---:|:-------------:|:--------:|:--------:|:--:|:---------:|\n|d        | -1.60 | 2.63 |   4 | (-9.00, 3.00) |    -0.55 |     0.30 | 40 |         0 |\n:::\n:::\n\n\n\nUm die Daten noch anders  visualisieren zu k√∂nnen, formen wir sie ins \"lange Format\" um.\n\n\n::: {.cell hash='090-Modellieren_cache/html/unnamed-chunk-34_4e0cf5342add93755fa05e7c9460dba5'}\n\n```{.r .cell-code}\nd_long <-\n  d_within %>% \n  pivot_longer(cols = c(y1, y2), names_to = \"time\", values_to = \"y\")\n```\n:::\n\nHier ist ein Auszug aus der Tabelle:\n\n\n::: {.cell hash='090-Modellieren_cache/html/unnamed-chunk-35_b6190a0c9375e68065f3955290e883bf'}\n\n```{.r .cell-code}\nhead(d_long)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"id\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"d\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"time\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"y\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"-1\",\"3\":\"y1\",\"4\":\"7\"},{\"1\":\"1\",\"2\":\"-1\",\"3\":\"y2\",\"4\":\"8\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"y1\",\"4\":\"7\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"y2\",\"4\":\"7\"},{\"1\":\"3\",\"2\":\"-5\",\"3\":\"y1\",\"4\":\"4\"},{\"1\":\"3\",\"2\":\"-5\",\"3\":\"y2\",\"4\":\"9\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\nVisualisieren wir uns die Daten, s. @fig-d2.\n\n\n::: {.cell hash='090-Modellieren_cache/html/fig-d2_6d66523486d0630910d51b2ca3170cdc'}\n\n```{.r .cell-code}\nggwithinstats(\n  data = d_long,\n  x = time,\n  y = y,\n  results.subtitle = FALSE  # verzichte auf zus√§tzliche Statistiken\n)\n```\n\n::: {.cell-output-display}\n![Der Unterschied in der Behaltensleistung pro Versuchsperson; im Durchschnitt ist der Wert bei y2 h√∂her als bei y1](090-Modellieren_files/figure-html/fig-d2-1.png){#fig-d2 width=672}\n:::\n:::\n\n\n\n### Inferenzanalyse\n\nWir berechnen das Modell (`m_within`),s. @tbl-d2-params:\n\n\n::: {.cell hash='090-Modellieren_cache/html/unnamed-chunk-37_9fea8b9702d7d45f5ae4115bb9754d79'}\n\n```{.r .cell-code}\nm_within <- stan_glm(d ~ 1, data = d_within, refresh = 0, seed = 42)\nparameters(m_within)\n```\n:::\n\n::: {#tbl-d2-params .cell tbl-cap='Modellparameter von m_within' hash='090-Modellieren_cache/html/tbl-d2-params_908d22a828ac18eb743c0d7c69f5ecd3'}\n::: {.cell-output-display}\n|Parameter   | Median |         95% CI |     pd |  Rhat |     ESS |                  Prior |\n|:-----------|:------:|:--------------:|:------:|:-----:|:-------:|:----------------------:|\n|(Intercept) |  -1.60 | (-2.43, -0.78) | 99.92% | 1.001 | 2537.00 | Normal (-1.60 +- 6.57) |\n:::\n:::\n\n\n\nHier ist eine Visualisierung des 95%-ETI des Unterschieds (`d`) zwischen den beiden Bedingungen (@fig-m-within-params).\n\n\n::: {.cell hash='090-Modellieren_cache/html/fig-m-within-params_57af27339639e9191044570dcce9bccc'}\n\n```{.r .cell-code}\nparameters(m_within) %>% plot(show_intercept = TRUE)\n```\n\n::: {.cell-output-display}\n![95%-CI f√ºr d (Achsenabschnitt mit Modell m_within)](090-Modellieren_files/figure-html/fig-m-within-params-1.png){#fig-m-within-params width=672}\n:::\n:::\n\n\n:::{.callout-note}\nWenn Sie die `parameters` `plot`ten und nur einen Intercept haben, m√ºssen Sie mit `show_intercept=TRUE` einschalten, dass er gezeigt wird.\nSonst gibt es eine Fehlermeldung.$\\square$\n:::\n\nWie man sieht, ist die Null nicht im CI enthalten. Wir k√∂nnen daher res√ºmieren,\ndass es einen Unterschied zwischen den Bedingungen (statisch vs. animiert) gibt hinsichtlich `y2` (Behaltensleistung). Die Behaltensleistung animierter Diagramme ist der von statischen Diagrammen √ºberlegen (laut diesem Modell).\nDie exakte Nullhypothese ist zu verwerfen.\nNat√ºrlich k√∂nnte man jetzt noch ein Rope berechnen.\n\n\n### Vertiefung\n\n\nIn [diesem Blog-Post](https://data-se.netlify.app/2022/06/04/vorher-nachher-messung-und-vergleich-zwischen-gruppen/) findet eine kleine Fallstudie zur Analyse von \"Vorher-Nachher-Daten\".\n\n\n## 1 within-Variable, 1 between-Variable\n\n### Design\n\nForschungsfrage:\n\n\n>    Hat die Diagrammart einen Einfluss auf die Behaltensleistung? Anders gesagt: Unterscheiden sich die Diagrammarten in ihrem Einfluss auf die Behaltensleistung? Dabei kontrollieren wir die Reihenfolge.\n\nForschungspraktisch bedeutet das, dass es zwei Gruppen, `g1` und `g2` in diesem Experiment gibt.\nDiese beiden Gruppen definieren eine between-Variable, `g`, die die Reihenfolge der Darbietung kontrolliert, s. @fig-within2-flow.\nDie Diagrammart `D` ist auch eine UV, aber als Within-Variable konzipiert.\n\n\n\n```{mermaid}\n%%| label: fig-within2-flow\n%%| fig-cap: \"Ablaufdiagramm f√ºr die Studie mit der Modellgleichung mit einem Within- und einem Between-Faktor\"\nflowchart LR\n  subgraph g2\n    direction LR\n    V.1 --> y1 --> V.2 --> y2\n  end\n  subgraph g1\n    direction LR\n    D2[V.2] --> y22[y2] --> D1[V.1] --> y11[y1] \n  end\n```\n\n\n\n\nDa es zwei UVs gibt, gibt es auch zwei Hypothesen:\n\n1. H1: $\\bar{d} < 0$, mit $d = y_1 - y_2$: Die mittlere Behaltensleistung ist in der Bedingung *animiert*  h√∂her als in der Bedingung *statisch*.\n2. H2: $\\bar{d}_{g.1} = \\bar{d}_{g.2}$: Der Unterschied in der Behaltensleistung zwischen den zwei Bedingung unterscheidet sich nicht von der Reihenfolge der Darbietung.\n\n\n\nDie Modellformel lautet: `y ~ 1 + g`.\nDas kann man synonym so schreiben: `y ~ g`.\n`y` meint die Behaltensleistung;\nstatisch erfassen wir den *Effekt* auf `y` anhand des Differenzma√ües `d`.\n\n\n\nDer DAG des Experiments ist in @fig-within2-dag dargestellt.\n\n\n\n::: {.cell fig.asp='0.5' hash='090-Modellieren_cache/html/fig-within2-dag_8fe40693373f4ec7f0acb9e1616093bb'}\n::: {.cell-output-display}\n![DAG f√ºr die Studie mit der Modellgleichung mit einem Within- und einem Between-Faktor. Es wird kein Effekt f√ºr g erwartet (daher kein Pfeil von g auf y), wohl aber ein Effekt f√ºr V](090-Modellieren_files/figure-html/fig-within2-dag-1.png){#fig-within2-dag width=100%}\n:::\n:::\n\n\n\n\n### Deskriptive Analyse\n\nHier sind einige Spieldaten:\n\n\n::: {.cell hash='090-Modellieren_cache/html/unnamed-chunk-42_838f57802f732838e6d84ef61d6bf358'}\n\n```{.r .cell-code}\nd_within <- \n  read_csv(\"https://raw.githubusercontent.com/sebastiansauer/Lehre/main/data/withindesign.csv\") %>% \n  select(-c(y3)) # die  Variable `y3` ignorieren wir f√ºr den Augenblick\n\nhead(d_within)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"id\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y1\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y2\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"g\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"1\",\"2\":\"7\",\"3\":\"8\",\"4\":\"A\"},{\"1\":\"2\",\"2\":\"7\",\"3\":\"7\",\"4\":\"A\"},{\"1\":\"3\",\"2\":\"4\",\"3\":\"9\",\"4\":\"A\"},{\"1\":\"4\",\"2\":\"7\",\"3\":\"4\",\"4\":\"A\"},{\"1\":\"5\",\"2\":\"6\",\"3\":\"7\",\"4\":\"A\"},{\"1\":\"6\",\"2\":\"5\",\"3\":\"4\",\"4\":\"A\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\nWir berechnen `d`, der Unterschied zwischen den beiden Bedingungen:\n\n\n::: {.cell hash='090-Modellieren_cache/html/unnamed-chunk-43_7473ec691262367ea649e2cf7d387140'}\n\n```{.r .cell-code}\nd_within <-\n  d_within %>% \n  mutate(d = y1 - y2)\n\nhead(d_within)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"id\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y1\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y2\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"g\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"d\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"7\",\"3\":\"8\",\"4\":\"A\",\"5\":\"-1\"},{\"1\":\"2\",\"2\":\"7\",\"3\":\"7\",\"4\":\"A\",\"5\":\"0\"},{\"1\":\"3\",\"2\":\"4\",\"3\":\"9\",\"4\":\"A\",\"5\":\"-5\"},{\"1\":\"4\",\"2\":\"7\",\"3\":\"4\",\"4\":\"A\",\"5\":\"3\"},{\"1\":\"5\",\"2\":\"6\",\"3\":\"7\",\"4\":\"A\",\"5\":\"-1\"},{\"1\":\"6\",\"2\":\"5\",\"3\":\"4\",\"4\":\"A\",\"5\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nBetrachten wir den Unterschied von `d` zwischen den Gruppen (H2), s. @fig-d-within2.\n\n\n::: {.cell hash='090-Modellieren_cache/html/fig-d-within2_ed84172534c59d964dbe9d94ff7eadf5'}\n\n```{.r .cell-code}\nggbetweenstats(\n  d_within,\n  x = g,\n  y = d,\n  results.subtitle = FALSE\n)\n```\n\n::: {.cell-output-display}\n![Der Unterschied der Behaltensleistung (d) in Abh√§ngigkeit von der Reihenfolge der Darbietung](090-Modellieren_files/figure-html/fig-d-within2-1.png){#fig-d-within2 width=672}\n:::\n:::\n\n\nEs gibt einen gewissen Unterschied zwischen den beiden Reihenfolgen (A und B) wie @fig-d-within2 zeigt;\ndie Reihenfolge k√∂nnte also einen Einfluss auf `d` haben.\nAber wir m√ºssen inferenzstatistisch pr√ºfen, wie gro√ü der Einfluss ist.\n\n\n\n### Inferenzanalyse\n\nBerechnen wir `m_within2`, das nicht nur den Intercept pr√ºft (wie `m_within1`), \nsondern auch zus√§tzlich den Effekt der Reihenfolge (`g`), vgl. @tbl-m_within2-params.\n\n\n::: {.cell hash='090-Modellieren_cache/html/m-within2_846e357eef3ca0fcebc3393437cce70b'}\n\n```{.r .cell-code}\nm_within2 <- stan_glm(d ~ g, data = d_within, refresh = 0, seed = 42)\n```\n:::\n\n::: {#tbl-m_within2-params .cell tbl-cap='Modellparameter von m_within2' hash='090-Modellieren_cache/html/tbl-m_within2-params_a3b18b3a9b8e7b8ab0e4a37899e75dd0'}\n::: {.cell-output-display}\n|Parameter   | Median |        95% CI |     pd |  Rhat |     ESS |                  Prior |\n|:-----------|:------:|:-------------:|:------:|:-----:|:-------:|:----------------------:|\n|(Intercept) |  -1.15 | (-2.34, 0.04) | 97.15% | 1.001 | 3568.00 | Normal (-1.60 +- 6.57) |\n|gB          |  -0.91 | (-2.57, 0.71) | 86.62% | 1.001 | 3295.00 | Normal (0.00 +- 12.98) |\n:::\n:::\n\n\n\nDas CI f√ºr die Reihenfolge (Variable `gB`) beinhaltet die Null;\nDaher kann ein Nulleffekt der Reihenfolge - also kein Effekt der Reihenfolge - nicht ausgeschlossen werden, `g=0` ist also im Bereich der plausiblen Werte.\n\nDer Effekt f√ºr `d` (`(Intercept)`) zeigt ein Intervall, das die Null (knapp) enth√§lt.\nDaher k√∂nnen wir wir die Nullhypothese nicht mit hoher Sicherheit ausschlie√üen.\n\nIn Summe:\n\n1. H1 (H√∂here Behaltensleistung von *animiert*) konnte nicht best√§tigt werden, aber tendenziell fand sich ein Effekt in erwarteter Richtung (zugunsten einer h√∂heren Behaltensleistung von *animiert*).\n2. H2 (Reihenfolgeeffekt) konnte nicht best√§tigt werden.\n\n\n## Vertiefung\n\n\n\n### 1 within-Variable mit mehr als zwei Stufen\n\n{{< fa dumbbell >}} VERTIEFUNG {{< fa dumbbell >}} - Sie k√∂nnen diesen Abschnitt ohne Gefahr ignorieren.\n\n\n### Design\n\nEine Forscherin hat die Gesundheit (`y`) von Studentis drei Mal (t1, t2, t3) im Zeitraum eines Semesters untersucht.\n\nIhre Forschungsfrage lautet, ob sich die Gesundheit im Laufe des Semesters substanziell ver√§ndert.\nIhre Hypothese lautet, dass die Werte √ºber die Zeit hinweg stabil bleiben.\n\n### Deskriptive Analyse\n\nHier sind einige Spieldaten:\n\n\n::: {.cell hash='090-Modellieren_cache/html/unnamed-chunk-46_ce468b78ddecc92647d0801664480fca'}\n\n```{.r .cell-code}\nd_within <- \n  read_csv(\"https://raw.githubusercontent.com/sebastiansauer/Lehre/main/data/withindesign.csv\")\n\nhead(d_within)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"id\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y1\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y2\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y3\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"g\"],\"name\":[5],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"1\",\"2\":\"7\",\"3\":\"8\",\"4\":\"9\",\"5\":\"A\"},{\"1\":\"2\",\"2\":\"7\",\"3\":\"7\",\"4\":\"10\",\"5\":\"A\"},{\"1\":\"3\",\"2\":\"4\",\"3\":\"9\",\"4\":\"9\",\"5\":\"A\"},{\"1\":\"4\",\"2\":\"7\",\"3\":\"4\",\"4\":\"9\",\"5\":\"A\"},{\"1\":\"5\",\"2\":\"6\",\"3\":\"7\",\"4\":\"8\",\"5\":\"A\"},{\"1\":\"6\",\"2\":\"5\",\"3\":\"4\",\"4\":\"9\",\"5\":\"A\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nHier ben√∂tigen wir die Daten in Langform:\n\n\n\n::: {.cell hash='090-Modellieren_cache/html/unnamed-chunk-47_832db08bae74c59275a300e8f54b7d42'}\n\n```{.r .cell-code}\nd_long <-\n  d_within %>% \n  pivot_longer(cols = y1:y3, names_to = \"time\", values_to = \"y\")\n\nhead(d_long)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"id\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"g\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"time\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"y\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"A\",\"3\":\"y1\",\"4\":\"7\"},{\"1\":\"1\",\"2\":\"A\",\"3\":\"y2\",\"4\":\"8\"},{\"1\":\"1\",\"2\":\"A\",\"3\":\"y3\",\"4\":\"9\"},{\"1\":\"2\",\"2\":\"A\",\"3\":\"y1\",\"4\":\"7\"},{\"1\":\"2\",\"2\":\"A\",\"3\":\"y2\",\"4\":\"7\"},{\"1\":\"2\",\"2\":\"A\",\"3\":\"y3\",\"4\":\"10\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\nEs hilft (wie meistens), sich die Daten zu visualisieren, s. @fig-within-y3.\n\n\n::: {#fig-within-y3 .cell layout-ncol=\"2\" hash='090-Modellieren_cache/html/fig-within-y3_4545d34a19d7e6ceea4830f991c53291'}\n\n```{.r .cell-code}\np_y123_a <-\n  d_long %>% \n  ggplot(aes(x = time, y = y)) +\n  geom_jitter(width = .2)\n\np_y123_b <-\n  ggwithinstats(d_long, \n                x = time,\n                y = y,\n                results.subtitle = FALSE)\n\np_y123_a\np_y123_b\n```\n\n::: {.cell-output-display}\n![Einfaches Punktediagramm](090-Modellieren_files/figure-html/fig-within-y3-1.png){#fig-within-y3-1 width=672}\n:::\n\n::: {.cell-output-display}\n![Informationsreiches Punkte-, Boxplot- und Violinendiagramm mit Statistiken der Ver√§nderung angereichert](090-Modellieren_files/figure-html/fig-within-y3-2.png){#fig-within-y3-2 width=672}\n:::\n\nMesswerte (y) in Abh√§ngigkeit vom Messzeitpunkt (t1, t2, t3)\n:::\n\n\n\nBerechnen wir die Mittelwerte von `y` pro Messzeitpunkte sowie die Ver√§nderung von t1 zu t2 bzw. von t2 zu t3, s. @tbl-d123.\n\n\n::: {.cell hash='090-Modellieren_cache/html/unnamed-chunk-49_a1347a5f00f94e0319a168d828ec8847'}\n\n```{.r .cell-code}\nd_long %>% \n  group_by(time) %>% \n  summarise(y_mean = mean(y)) %>% \n  mutate(d = y_mean - lag(y_mean))\n```\n:::\n\n::: {#tbl-d123 .cell tbl-cap='Mittelwerte von `y` pro Messzeitpunkte (`y_mean`) sowie die Ver√§nderung von t1 zu t2 bzw. von t2 zu t3 (`d`)' hash='090-Modellieren_cache/html/tbl-d123_d954068f62a6457f9fe6ef0fb588d767'}\n::: {.cell-output-display}\n|time | y_mean|    d|\n|:----|------:|----:|\n|y1   |   5.45|     |\n|y2   |   7.05| 1.60|\n|y3   |   8.97| 1.92|\n:::\n:::\n\n\n\n\n### Inferenzanalyse\n\n\n\n\n::: {.cell hash='090-Modellieren_cache/html/unnamed-chunk-51_c5c66ac020847b5716217ade0594ce67'}\n\n```{.r .cell-code}\nm_within3 <- stan_lmer(y ~ 1 + (1 | time), data = d_long, refresh = 0)\nsummary(m_within3)\n## \n## Model Info:\n##  function:     stan_lmer\n##  family:       gaussian [identity]\n##  formula:      y ~ 1 + (1 | time)\n##  algorithm:    sampling\n##  sample:       4000 (posterior sample size)\n##  priors:       see help('prior_summary')\n##  observations: 120\n##  groups:       time (3)\n## \n## Estimates:\n##                                       mean   sd   10%   50%   90%\n## (Intercept)                          7.2    1.3  5.7   7.2   8.6 \n## b[(Intercept) time:y1]              -1.7    1.3 -3.2  -1.7  -0.2 \n## b[(Intercept) time:y2]              -0.1    1.3 -1.6  -0.1   1.4 \n## b[(Intercept) time:y3]               1.8    1.3  0.3   1.8   3.3 \n## sigma                                1.5    0.1  1.3   1.5   1.6 \n## Sigma[time:(Intercept),(Intercept)]  5.0    5.9  1.2   3.2  10.9 \n## \n## Fit Diagnostics:\n##            mean   sd   10%   50%   90%\n## mean_PPD 7.2    0.2  6.9   7.2   7.4  \n## \n## The mean_ppd is the sample average posterior predictive distribution of the outcome variable (for details see help('summary.stanreg')).\n## \n## MCMC diagnostics\n##                                     mcse Rhat n_eff\n## (Intercept)                         0.0  1.0   980 \n## b[(Intercept) time:y1]              0.0  1.0   997 \n## b[(Intercept) time:y2]              0.0  1.0   993 \n## b[(Intercept) time:y3]              0.0  1.0  1017 \n## sigma                               0.0  1.0  2706 \n## Sigma[time:(Intercept),(Intercept)] 0.1  1.0  1538 \n## mean_PPD                            0.0  1.0  4381 \n## log-posterior                       0.1  1.0  1137 \n## \n## For each parameter, mcse is Monte Carlo standard error, n_eff is a crude measure of effective sample size, and Rhat is the potential scale reduction factor on split chains (at convergence Rhat=1).\n```\n:::\n\n\nDie Schreibweise `(1 | time)` soll sagen, dass die Messwerte innerhalb von `time` verschachtelt sind und variieren. \nDie `1` sagt, dass es sich bei der variierenden Gr√∂√üe um den Intercept handelt,\nnicht um eine UV.\n\nEin \"fixer\" Effekt ist ein Effekt, f√ºr den kein Pooling stattfindet,\ndas ist hier der Intercept.\n\nNur die festen (*fixed*) Effekte kann man sich so ausgeben lassen:\n\n\n::: {.cell hash='090-Modellieren_cache/html/unnamed-chunk-52_05a08f25ff11e15d97c11da62c5118fd'}\n\n```{.r .cell-code}\nfixef(m_within3)\n## (Intercept) \n##    7.163938\n```\n:::\n\n\n\nIm Durchschnitt werden ca. 7.1 Fragen richtig beantwortet (Gesamtmittel);\ndas ist die Information die der Punktsch√§tzer des Intercepts bietet.\n\n\nNur die Random-Effekte kann man sich so ausgeben lassen:\n\n\n::: {.cell hash='090-Modellieren_cache/html/unnamed-chunk-53_822626d540527705fcc2ad1e23c0df16'}\n\n```{.r .cell-code}\nranef(m_within3)\n## $time\n##    (Intercept)\n## y1  -1.6757393\n## y2  -0.1142049\n## y3   1.7701076\n## \n## with conditional variances for \"time\"\n```\n:::\n\n\nDas sind jeweils die Abweichungen der Gruppenmittelwerte (y1, y2, y3) vom Gesamtmittel.\nDie Random-Effekte kann man sich visualisieren lassen, s. @fig-randef-m3.\n\n\n::: {.cell hash='090-Modellieren_cache/html/fig-randef-m3_95cb4b5e14849ef2b253dd050437fa30'}\n\n```{.r .cell-code}\nplot(m_within3)\n```\n\n::: {.cell-output-display}\n![95%-CI der Random-Effekte von `m_within3`](090-Modellieren_files/figure-html/fig-randef-m3-1.png){#fig-randef-m3 width=672}\n:::\n:::\n\n\n\n\n### Mediatoranalyse\n\n[Hier](https://wgruber.github.io/Modellbildung2/mediation.html) findet sich eine Einf√ºhrung in die Mediationsanalyse.\n[Dieses R-Paket](https://github.com/GerkeLab/mediator/tree/master) stellt ebenfalls komfortable Funktionen zur Verf√ºgung f√ºr Mediationsanalysen.\n\n\n\n\n## Fazit\n\nUnter Modellieren versteht man in der Forschungspraxis meist ein Regressionsmodell der Form `av ~ uv`.\nDie Inferenzstatistik hilft, die Modellparameter mit Sch√§tzwerten f√ºr die Population zu versehen.\n\n\n## Aufgaben\n\n\nS. bei [Datenwerk]() die Aufgaben mit dem Tag [research-question](https://datenwerk.netlify.app/#category=research-question) und [researchdesign](https://datenwerk.netlify.app/#category=researchdesign)\n\n\n- [within-design-analysis1](https://datenwerk.netlify.app/posts/within-design-analysis1/within-design-analysis1.html)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}