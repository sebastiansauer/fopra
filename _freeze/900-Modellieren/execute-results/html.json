{
  "hash": "3e50ec29975f704ab431bbe4195f20c4",
  "result": {
    "markdown": "# Auswerten: Modellieren\n\n\n\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-2_3b2744316729f1633db6fef434f8d965'}\n\n:::\n\n\n## Lernsteuerung\n\n\n### Lernziele\n\n\n- Sie k√∂nnen die Modellformel Ihrer Forschungsfrage nennen.\n- Sie k√∂nnen Ihre Modellformel (korrekt) in R spezifizieren.\n- Sie k√∂nnen Ihr Modell in R berechnen und die Ausgabe interpretieren.\n- Sie k√∂nnen die G√ºltigkeit bzw. die Grenzen der Aussagen Ihres Modells einsch√§tzen.\n\n\n### Ben√∂tigte R-Pakete\n\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-3_5550c38e2557d76bae533dd1f291823c'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(easystats)\nlibrary(ggstatsplot)\nlibrary(rstanarm)\n```\n:::\n\n\n\n\n### Position im Lernpfad\n\nSie befinden sich im Abschnitt \"Auswerten\" in @fig-ueberblick.\n\n\n\n\n\n\n## Metrische AV, between-Design\n\n### 1 between-Variable\n\n#### Design\n\n@sauer_effect_2023 untersuchten in einer Querschnittsstudie den Effekt des Wirkstoff *Bringnixtin* auf die fluide Intelligenz. Die Autoren nahmen an, dass der Wirkstoff den individuellen Wert der abh√§ngigen Variable erh√∂hen w√ºrde.\n\n\nDer Ablauf (aus Sicht der Probandis) ist in @fig-bringtnixtin-flow dargestellt.\n`Intro` fasst die Begr√º√üung der Probandis inkl. Informed Consent sowie Erfassung von soziodemografischen Variablen zusammen.\n`g.0` und `g.1` sind die zwei Stufen der UV (*g* wie Gruppe), wobei `g.0` die Kontrollgruppe kodiert (Placebo, also Zuckerpille, kein Wirkstoff,) und `g.1` die *zweite* Stufe, d.h. die Experimentalgruppe (hohe Dosis Bringtnixtin).\n`y2` ist die Messung der AV (d.h. nach Gabe von Bringtnixtin), d.h. ein Ma√ü der fluiden Intelligenz.\n`outro` meint die Verabschiedung der Probanden sowie einige Fragen zu Compliance.\n\n\nDie Hypothese lautet: $\\mu_{g.2} > \\mu_{g.1}$. In Worten:\n\n>  Wir erwarten, dass der Mittelwert der Experimentalgruppe h√∂her ist als der Mittelwert der Kontrollgruppe.\n\n\n\n\n```{mermaid}\n%%| label: fig-bringtnixtin-flow\n%%| fig-cap: Ablaufdiagramm der Bringtnixtin-Studie\n\nflowchart LR\n  Intro --> g.0\n  Intro --> g.1\n  g.0 --> y2\n  g.1 --> y2\n  y2 --> outro\n```\n\n\nDer DAG des Experiments ist in @fig-bringtnixtin-dag dargestellt.\n\n\n\n::: {.cell fig.asp='0.5' hash='900-Modellieren_cache/html/fig-bringtnixtin-dag_e2a40691dc0de62ad6e9a900cf5c8b37'}\n::: {.cell-output-display}\n![DAG f√ºr der Bringtnixtin-Studie](900-Modellieren_files/figure-html/fig-bringtnixtin-dag-1.png){#fig-bringtnixtin-dag width=100%}\n:::\n:::\n\n::: {.cell hash='900-Modellieren_cache/html/d_bringtnixtin_1079b24c2a64830e1da4e995d24407a6'}\n\n:::\n\n\n\nDie Daten dieses Experiments sind hier zu beziehen:\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-6_de11075744cb7f68086a03f5f092bde0'}\n\n```{.r .cell-code}\nd_bringtnixtin_path <- \"https://raw.githubusercontent.com/sebastiansauer/fopra/main/data/d_bringtnixtin.csv\"\nd_bringtnixtin <- read_csv(d_bringtnixtin_path)\n```\n:::\n\n{{< downloadthis data/d_bringtnixtin.csv >}}\n\n\n\nDie Autoren der Studie geben an, dass die Daten in z-Einheiten skaliert sind.\n\n\n#### Deskriptive Analyse\n\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-7_3756c0430c67af5eebcbcfd6a7118b98'}\n\n```{.r .cell-code}\nd_bringtnixtin %>% \n  group_by(g) %>% \n  summarise(iq_mw = mean(y2),\n            iq_sd = sd(y2)) \n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"g\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"iq_mw\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"iq_sd\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0\",\"2\":\"0.1917379\",\"3\":\"1.337211\"},{\"1\":\"1\",\"2\":\"-0.5722050\",\"3\":\"1.110908\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nDie deskiptiven Kennwerte sind in @fig-bringtnixtin-desk dargestellt.\nDas sieht nicht gerade nach einem gro√üen Effekt aus ...^[Die Mittelwerte der beiden Gruppen sind praktisch identisch.]\n\n\n\n::: {.cell hash='900-Modellieren_cache/html/fig-bringtnixtin-desk_06f04055953aae6214d858cb454da432'}\n\n```{.r .cell-code}\nggbetweenstats(\n  data = d_bringtnixtin,\n  x = g,\n  y = y2,\n  results.subtitle = FALSE  # keine Statistiken zeigen\n)\n```\n\n::: {.cell-output-display}\n![Fluide Intelligenz (y2) nach der Bringtnixtin-Intervention. g=0: Kontrollgruppe (Placebo), g=1: Experimentalgruppe (hohe Dosis)](900-Modellieren_files/figure-html/fig-bringtnixtin-desk-1.png){#fig-bringtnixtin-desk width=672}\n:::\n:::\n\n\n\n\n#### Modellierung\n\n\nWir berechnen ein lineares Modell mit der Modellformel `y2 ~ g`. \nDie Ergebnisse sind in @tbl-m1-params zu sehen.\n\n\n::: {#tbl-m1-params .cell tbl-cap='Parameter des Modells m_bringtnixtin' hash='900-Modellieren_cache/html/tbl-m1-params_da757a3dd9437251bfb701d6bed1fc7c'}\n\n```{.r .cell-code}\nm_bringtnixtin <- stan_glm(y2 ~ g, data = d_bringtnixtin, refresh = 0)\nparameters(m_bringtnixtin)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Parameter\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Median\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_low\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_high\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"pd\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Rhat\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"ESS\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Prior_Distribution\"],\"name\":[9],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Prior_Location\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Prior_Scale\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"(Intercept)\",\"2\":\"0.1935558\",\"3\":\"0.95\",\"4\":\"-0.363549\",\"5\":\"0.74670987\",\"6\":\"0.75275\",\"7\":\"1.000637\",\"8\":\"3399.861\",\"9\":\"normal\",\"10\":\"-0.1902336\",\"11\":\"3.183966\"},{\"1\":\"g\",\"2\":\"-0.7637960\",\"3\":\"0.95\",\"4\":\"-1.568911\",\"5\":\"0.02499465\",\"6\":\"0.97100\",\"7\":\"1.000745\",\"8\":\"3374.092\",\"9\":\"normal\",\"10\":\"0.0000000\",\"11\":\"6.287828\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nDie Punkt- und Intervallsch√§tzer (95%-ETI) sind in @fig-m1-params dargestellt.\n\n\n::: {.cell hash='900-Modellieren_cache/html/fig-m1-params_c96629881aa43f88f662e17a30050efe'}\n\n```{.r .cell-code}\nparameters(m_bringtnixtin) %>% plot(show_intercept = TRUE)\n```\n\n::: {.cell-output-display}\n![Parameter des Modells `m_bringtnixtin`](900-Modellieren_files/figure-html/fig-m1-params-1.png){#fig-m1-params width=672}\n:::\n:::\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-11_5ccad3c6e0e2ce3545fbddeca6623618'}\n\n:::\n\n\n\n\nDer Gruppenunterschied wird auf 0.19, -0.76 gesch√§tzt;\ndas ist der Punktsch√§tzer der UV `g`.\nDie Grenzen eines 95%-CI f√ºr die UV liegen bei -1.55 bzw. 0.04.\nDieser Bereich enth√§lt die Null, vgl. @fig-m1-params.\nDaher kann nicht ausgeschlossen werden,\ndass Bringtnixtin nix bringt.\n\n>   üë®‚Äçüè´ Frau Professor Lustig, wie kann das sein, dass sich die Hypothese nicht best√§tigt?\n\n>   üë©‚Äçüè´ Herr Professor Sauer, auch ein negatives Ergebnis bringt die Wissenschaft weiter.\n\n\nTesten wir eine Nullhypothese mit dem ROPE-Verfahren, s. @tbl-m1-rope und @fig-m1-rope.\n\n\n::: {#tbl-m1-rope .cell tbl-cap='ROPE f√ºr Modell m_bringtnixtin' hash='900-Modellieren_cache/html/tbl-m1-rope_d00a099ed039b66f6333aa87a8b81576'}\n\n```{.r .cell-code}\nrope(m_bringtnixtin)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Parameter\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"CI\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"ROPE_low\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"ROPE_high\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"ROPE_Percentage\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Effects\"],\"name\":[6],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Component\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"(Intercept)\",\"2\":\"0.95\",\"3\":\"-0.1273586\",\"4\":\"0.1273586\",\"5\":\"0.28684211\",\"6\":\"fixed\",\"7\":\"conditional\",\"_rn_\":\"1\"},{\"1\":\"g\",\"2\":\"0.95\",\"3\":\"-0.1273586\",\"4\":\"0.1273586\",\"5\":\"0.03447368\",\"6\":\"fixed\",\"7\":\"conditional\",\"_rn_\":\"2\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n::: {.cell hash='900-Modellieren_cache/html/fig-m1-rope_9ecc697a25acb42f930ee88658497076'}\n\n```{.r .cell-code}\nrope(m_bringtnixtin) %>% plot()\n```\n\n::: {.cell-output-display}\n![ROPE f√ºr MOdell m_bringtnixtin](900-Modellieren_files/figure-html/fig-m1-rope-1.png){#fig-m1-rope width=672}\n:::\n:::\n\n\n\nDa sich das 95%-CI mit dem ROPE √ºberlappt, kann die Nullhypothese bzw. das ROPE (kein praktisch bedeutsamer Effekt) *nicht* ausgeschlossen werden.\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-14_1ad9d8de155600ada673cdaa7121fc9b'}\n\n:::\n\n\n\n\nEine vergleichbare Information bietet uns die Kennzahl `pd`, s. @tbl-m1-params.\nDer Wert f√ºr `g` liegt bei ca. 0.97.\n\n:::{#callout-note}\n`pd` gibt die Wahrscheinlichkeit (laut Modell) an, dass der Effekt in der Population negativ bzw. positiv ist (d.h. gleich dem Vorzeichen des Punktsch√§tzers; in diesem Fall negativ).$\\square$\n:::\n\n<!-- Das Modell ist sich nicht sehr sicher, in welche Richtung der Effekt von Bringtnixtin zeigt. -->\n<!-- Das Modell neigt eher zur Meinung, dass der Effekt von `g` (in der Population) *negativ* ist. Ganz sicher ist sich aber das Modell nicht. -->\nDas Modell ist sicher ziemlich sicher, dass der Effekt von `g` (in der Population) *negativ* ist. \n\n>   üë®‚Äçüè´ Frau Professor Lustig, oh je!\n\n>   üë©‚Äçüè´ Herr Professor Sauer, wir m√ºssen erst einmal in Ruhe die Studie replizieren. Eine Schwalbe macht noch keinen Fr√ºhling.\n\n\n\n### Vorher-Nachher-Messung, 1 between-Variable\n\n\n#### Design\n\n@sauer_effect_2023 fiel auf, dass es sinnvoller ist, zuerst die AV mittels eines Vortests zu messen, dann die Intervention anzuwenden, und dann nachher (Posttest) die AV wieder zu messen.\nDaher haben sie sowohl vor der Intervention (`y1`) als auch nach der Intervention (Gabe von Bringtnixtin), `y2` die AV gemesessen.\n\n\n:::{#callout-note}\nEine Vorher-Nachher-Messung hat den Verteil, dass sie - im Gegensatz zur Nur-Nachher-Messung - unterschiedliche Ausgangswerte in der AV herausrechnet. \nBei gro√üen Gruppen wird sich bei einer randomisierten Zuweisung zu den Gruppen der Ausgangswert der AV angleichen. Bei nicht so gro√üen Gruppen kann aber auch bei Randomisierung ein - mitunter erheblicher - Unterschied zwischen den Gruppen verbleiben.\nFindet man bei der Post-Messung einen Effekt, so kann es sein, dass dieser nicht auf die Intervention beruht, sondern auf die von vornherein vorhandenen Unterschieden zwischen den Gruppen.$\\square$\n:::\n\n\n:::{#callout-note}\nVergleicht man die Delta-Werte zwischen zwei Gruppen,\nberechnet man die Differenz zwischen den Gruppen der Delta-Werte.\nMan spricht daher von einer *Difference-in-Difference-Analyse*.$\\square$\n:::\n\n\n\n@fig-bringtnixtin-flow2 zeigt den Ablaufplan dieses Experiments.\n\n\n```{mermaid}\n%%| label: fig-bringtnixtin-flow2\n%%| fig-cap: Ablaufdiagramm der Bringtnixtin-Studie\n\nflowchart LR\n  Intro --> y1\n  y1 --> g.1\n  y1 --> g.2\n  g.1 --> y2\n  g.2 --> y2\n  y2 --> outro\n```\n\n\nDAG des Experiments ist in @fig-bringtnixtin-dag2 dargestellt.\n\n\n\n::: {.cell fig.asp='0.5' hash='900-Modellieren_cache/html/fig-bringtnixtin-dag2_b922482029c286b8a62c7fd268198aad'}\n::: {.cell-output-display}\n![DAG f√ºr der Bringtnixtin-Studie](900-Modellieren_files/figure-html/fig-bringtnixtin-dag2-1.png){#fig-bringtnixtin-dag2 width=100%}\n:::\n:::\n\n#### Deskriptive Analyse\n\nEine einfache (und sinnvolle) Art, solche Studiendesigns auszuwerten ist die Bildung einer Differenz-Variable^[auch Delta-Veriable genannt].\nDiese Differenzvariable gibt die Ver√§nderung der fluiden Intelligenz durch die Intervention an.\nAnders gesagt: Die Differenz ist die IQ-Wert einer Person *nach* der Intervention minus dem IQ-Wert *vor* der Intervention: $d = y_2 - y_1$:\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-17_e95f330f2df459b1c2a7dd7912ab91bf'}\n\n```{.r .cell-code}\nd_bringtnixtin <-\n  d_bringtnixtin %>% \n  mutate(d = y2 - y1)\n```\n:::\n\n\nSchauen wir uns die ersten paar d-Werte f√ºr jede der beiden Gruppen (`g=0?  bzw. `g=1`) an.\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-18_d9104378748cf09b530cb3bf4dc90c4d'}\n\n```{.r .cell-code}\nd_bringtnixtin %>% \n  group_by(g) %>% \n  slice_head(n = 5)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"id\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"g\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y1\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y2\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"d\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"0\",\"3\":\"1.3709584\",\"4\":\"1.4121582\",\"5\":\"0.04119972\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"-0.5646982\",\"4\":\"-0.6369096\",\"5\":\"-0.07221146\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"0.3631284\",\"4\":\"0.5147611\",\"5\":\"0.15163265\"},{\"1\":\"4\",\"2\":\"0\",\"3\":\"0.6328626\",\"4\":\"0.4875216\",\"5\":\"-0.14534097\"},{\"1\":\"5\",\"2\":\"0\",\"3\":\"0.4042683\",\"4\":\"0.1306121\",\"5\":\"-0.27365621\"},{\"1\":\"21\",\"2\":\"1\",\"3\":\"-0.3066386\",\"4\":\"-0.7134189\",\"5\":\"-0.40678026\"},{\"1\":\"22\",\"2\":\"1\",\"3\":\"-1.7813084\",\"4\":\"-2.0775957\",\"5\":\"-0.29628722\"},{\"1\":\"23\",\"2\":\"1\",\"3\":\"-0.1719174\",\"4\":\"-0.3888859\",\"5\":\"-0.21696859\"},{\"1\":\"24\",\"2\":\"1\",\"3\":\"1.2146747\",\"4\":\"1.1612887\",\"5\":\"-0.05338597\"},{\"1\":\"25\",\"2\":\"1\",\"3\":\"1.8951935\",\"4\":\"1.4164017\",\"5\":\"-0.47879175\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n<!-- Puh! Das Bringtnixtin scheint die IQ zu *verringern*, zumindest in einigen F√§llen. -->\n\n\n\n\nVielleicht ist es anschaulicher, wenn wir die Gruppe `0` in den Text `Kontrollgruppe` umbenennen und `1` in `Experimentalgruppe`:\n\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-19_ec71b24fe25bf60114a713402d3df81e'}\n\n```{.r .cell-code}\nd_bringtnixtin <-\n  d_bringtnixtin %>% \n  mutate(g_text =\n           case_when(g == 0 ~ \"Kontrollgruppe\",\n                     g == 1 ~ \"Experimentalgruppe\"))\n```\n:::\n\n\nHier sind die Mittelwerte f√ºr jede der beiden Gruppen:\n\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-20_64393020883335f56f17a7b7e9d5f86e'}\n\n```{.r .cell-code}\nd_bringtnixtin %>% \n  group_by(g_text) %>%\n  summarise(d = mean(d))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"g_text\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"d\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Experimentalgruppe\",\"2\":\"-0.3012131904\"},{\"1\":\"Kontrollgruppe\",\"2\":\"-0.0001821443\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nDie deskiptiven Kennwerte sind in @fig-bringtnixtin-desk2 dargestellt.\n\n\n\n::: {.cell hash='900-Modellieren_cache/html/fig-bringtnixtin-desk2_fdc393ec09a0a11eccdb2feb34a0dd68'}\n\n```{.r .cell-code}\nggbetweenstats(\n  data = d_bringtnixtin,\n  x = g_text,\n  y = d,\n  results.subtitle = FALSE  # keine Statistiken zeigen\n)\n```\n\n::: {.cell-output-display}\n![Ver√§nderung der fluiden Intelligenz (d) in Abh√§ngigkeit der Gruppe; g=0: Kontrollgruppe (Placebo), g=1: Experimentalgruppe (hohe Dosis)](900-Modellieren_files/figure-html/fig-bringtnixtin-desk2-1.png){#fig-bringtnixtin-desk2 width=672}\n:::\n:::\n\n\n\n\n#### Modellierung\n\nWir modellieren (in `m_bringtnixtin2`) jetzt die Ver√§nderung `d = y2 - y1` als AV; UV ist wieder `g`.\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-22_5d9948a61fea0d20135c2cc90755526e'}\n\n```{.r .cell-code}\nm_bringtnixtin2 <- stan_glm(d ~ g, data = d_bringtnixtin, refresh = 0)\nparameters(m_bringtnixtin2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Parameter\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Median\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_low\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_high\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"pd\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Rhat\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"ESS\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Prior_Distribution\"],\"name\":[9],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Prior_Location\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Prior_Scale\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"(Intercept)\",\"2\":\"-0.0001893511\",\"3\":\"0.95\",\"4\":\"-0.08643585\",\"5\":\"0.08285638\",\"6\":\"0.50175\",\"7\":\"1.000872\",\"8\":\"3311.846\",\"9\":\"normal\",\"10\":\"-0.1506977\",\"11\":\"0.5944137\"},{\"1\":\"g\",\"2\":\"-0.3003427224\",\"3\":\"0.95\",\"4\":\"-0.41477040\",\"5\":\"-0.18781999\",\"6\":\"0.99975\",\"7\":\"1.001468\",\"8\":\"3594.290\",\"9\":\"normal\",\"10\":\"0.0000000\",\"11\":\"1.1738729\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n@fig-bringtnixtin2-params zeigt die Parameterwerte f√ºr `m_bringtnixtin2`,\n\n\n::: {.cell hash='900-Modellieren_cache/html/fig-bringtnixtin2-params_ba0f83184092cf89a86e034706abe147'}\n\n```{.r .cell-code}\nplot(parameters(m_bringtnixtin2))\n```\n\n::: {.cell-output-display}\n![Parameterwerte von m_bringtnixtin2](900-Modellieren_files/figure-html/fig-bringtnixtin2-params-1.png){#fig-bringtnixtin2-params width=672}\n:::\n:::\n\n\n\nWie man den Parameterwerten entnehmen kann,\nist sich das Modell sehr sicher, dass der Effekt von Bringtnixtin *negativ* ist.\n<!-- ist sich das Modell nicht sicher, welche Richtung der Effekt von Bringtnixtin hat. -->\n\n\n### Weitere Beispiele\n\nG√§ngige Forschungsfragen dieser Art sind [hier](https://start-bayes.netlify.app/https://start-bayes.netlify.app/1000-metrische-av) erl√§utert.\n\n\n\n## Metrische AV, within-Design\n\n\n### 1 within-Variable\n\n\nEine Studie mit Vorher-Nachher-Messung setzt ein Within-Design um.\n\n\n:::{#exm-within1}\n### Statisches Diagramm vs. animiertes Diagramm\nEin Forschungsteam untersuch den Effekt der UV *Diagrammart* `D` (mit den zwei Stufen `D.1` *animiert* und `D.2` *statisch*) auf die Behaltensleistung (`y`) von Probanden.\nNach jeder Bedingung wird die Behaltensleistung gemessen (anhand von 10 Wissensfragen, die jeweils als \"richtig\" oder \"falsch\" bewertet wurden), mit `y1` nach `D.1` und `y2` f√ºr `D.2`.\n:::\n\n\n\n#### Design\n\n\nForschungsfrage:\n\n>    Hat die Diagrammart einen Einfluss auf die Behaltensleistung? Anders gesagt: Unterscheiden sich die Diagrammarten in ihrem Einfluss auf die Behaltensleistung?\n\n\nDie zugeh√∂rige Hypothese kann man so formulieren: $d \\ne 0$, wobei $d = y_1 - y_2$.\n\nDie Modellformel lautet: `d ~ 1`,\ndas ist ein *Interceptmodell*, also ein Modell ohne Pr√§diktor. \nUns interessiert, ob die Variable `d` im Mittelwert ungleich Null ist.\n\n\n```{mermaid}\nflowchart LR\n  D.1 --> y1 --> D.2 --> y2\n```\n\n\n\n#### Deskriptive Analyse\n\nHier sind einige Spieldaten:\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-25_2b8736158caf7a46b93e58de44ddf668'}\n\n```{.r .cell-code}\nd_within <- \n  read_csv(\"https://raw.githubusercontent.com/sebastiansauer/Lehre/main/data/withindesign.csv\") %>% \n  select(-c(y3, g)) # diese beiden Variablen ignorieren wir f√ºr den Augenblick\n\nhead(d_within)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"id\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y1\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y2\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"7\",\"3\":\"8\"},{\"1\":\"2\",\"2\":\"7\",\"3\":\"7\"},{\"1\":\"3\",\"2\":\"4\",\"3\":\"9\"},{\"1\":\"4\",\"2\":\"7\",\"3\":\"4\"},{\"1\":\"5\",\"2\":\"6\",\"3\":\"7\"},{\"1\":\"6\",\"2\":\"5\",\"3\":\"4\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n{{< downloadthis data/withindesign.csv >}}\n\n\n\nWir berechnen `d`:\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-26_b113bbbb0d6e6700cda847a3523fd369'}\n\n```{.r .cell-code}\nd_within <-\n  d_within %>% \n  mutate(d = y1 - y2)\n\nhead(d_within)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"id\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y1\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y2\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"d\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"7\",\"3\":\"8\",\"4\":\"-1\"},{\"1\":\"2\",\"2\":\"7\",\"3\":\"7\",\"4\":\"0\"},{\"1\":\"3\",\"2\":\"4\",\"3\":\"9\",\"4\":\"-5\"},{\"1\":\"4\",\"2\":\"7\",\"3\":\"4\",\"4\":\"3\"},{\"1\":\"5\",\"2\":\"6\",\"3\":\"7\",\"4\":\"-1\"},{\"1\":\"6\",\"2\":\"5\",\"3\":\"4\",\"4\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-27_2417808a444c29368395f5aac1237ac0'}\n\n```{.r .cell-code}\ngghistostats(d_within,\n             x = d,\n             results.subtitle = FALSE  # verzichte auf zus√§tzliche Statistiken\n             )\n```\n\n::: {.cell-output-display}\n![](900-Modellieren_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\nDa `d` im Mittel negativ ist, ist der Mittelwert von `y2` h√∂her als der von `y1`.\n\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-28_7eff960eb3659c2d91979f70b52d1eed'}\n\n```{.r .cell-code}\nd_within %>% \n  describe_distribution(d)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Variable\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Mean\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SD\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"IQR\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Min\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Max\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Skewness\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Kurtosis\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"n\"],\"name\":[9],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"n_Missing\"],\"name\":[10],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"d\",\"2\":\"-1.6\",\"3\":\"2.629224\",\"4\":\"4\",\"5\":\"-9\",\"6\":\"3\",\"7\":\"-0.5495719\",\"8\":\"0.3047316\",\"9\":\"40\",\"10\":\"0\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\nUm die Daten noch anders  visualisieren zu k√∂nnen, formen wir sie ins \"lange Format\" um.\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-29_aaee1a127b9e7186f324df035b664814'}\n\n```{.r .cell-code}\nd_long <-\n  d_within %>% \n  pivot_longer(cols = c(y1, y2), names_to = \"time\", values_to = \"y\")\n\nhead(d_long)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"id\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"d\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"time\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"y\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"-1\",\"3\":\"y1\",\"4\":\"7\"},{\"1\":\"1\",\"2\":\"-1\",\"3\":\"y2\",\"4\":\"8\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"y1\",\"4\":\"7\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"y2\",\"4\":\"7\"},{\"1\":\"3\",\"2\":\"-5\",\"3\":\"y1\",\"4\":\"4\"},{\"1\":\"3\",\"2\":\"-5\",\"3\":\"y2\",\"4\":\"9\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\nVisualisieren wir uns die Daten:\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-30_c5d5cb53b939ee25a4cc44b21d143d8e'}\n\n```{.r .cell-code}\nggwithinstats(\n  data = d_long,\n  x = time,\n  y = y,\n  results.subtitle = FALSE  # verzichte auf zus√§tzliche Statistiken\n)\n```\n\n::: {.cell-output-display}\n![](900-Modellieren_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n:::\n\n\n\n#### Inferenzanalyse\n\nWir berechnen das Modell:\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-31_619477fa4b9008daead109bb7ead0051'}\n\n```{.r .cell-code}\nm_within <- stan_glm(d ~ 1, data = d_within, refresh = 0)\nparameters(m_within)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Parameter\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Median\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_low\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_high\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"pd\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Rhat\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"ESS\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Prior_Distribution\"],\"name\":[9],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Prior_Location\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Prior_Scale\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"(Intercept)\",\"2\":\"-1.610182\",\"3\":\"0.95\",\"4\":\"-2.402513\",\"5\":\"-0.782229\",\"6\":\"0.9995\",\"7\":\"1.000675\",\"8\":\"2632.705\",\"9\":\"normal\",\"10\":\"-1.6\",\"11\":\"6.573061\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nHier ist eine Visualisierung des 95%-ETI des Unterschieds (`d`) zwischen den Bedingungen:\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-32_95b33479eadf3341c6cf929c1c7865a4'}\n\n```{.r .cell-code}\nparameters(m_within) %>% plot(show_intercept = TRUE)\n```\n\n::: {.cell-output-display}\n![](900-Modellieren_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n:::\n\n\n\n### 1 within-Variable, 1 between-Variable\n\n\n\n\n>    Hat die Diagrammart einen Einfluss auf die Behaltensleistung? Anders gesagt: Unterscheiden sich die Diagrammarten in ihrem Einfluss auf die Behaltensleistung? Dabei kontrollieren wir die Reihenfolge.\n\n\nDie zugeh√∂rige Hypothese kann man so formulieren: $d \\ne 0$, wobei $d = y_1 - y_2$.\n\nDie Modellformel lautet: `d ~ 1 + g`.\nDas kann man synonym so schreiben: `d ~ g`.\nUns interessiert, ob die Variable `d` im Mittelwert ungleich Null ist.\n\n\n\n\n```{mermaid}\nflowchart LR\n  subgraph g2\n    direction LR\n    D.1 --> y1 --> D.2 --> y2\n  end\n  subgraph g1\n    direction LR\n    D2[D.2] --> y22[y2] --> D1[D.1] --> y11[y1] \n  end\n```\n\n\n\n#### Deskriptive Analyse\n\nHier sind einige Spieldaten:\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-34_2fbb60bd973fc8cad40c2b53986dd519'}\n\n```{.r .cell-code}\nd_within <- \n  read_csv(\"https://raw.githubusercontent.com/sebastiansauer/Lehre/main/data/withindesign.csv\") %>% \n  select(-c(y3)) # die  Variable `y3` ignorieren wir f√ºr den Augenblick\n\nhead(d_within)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"id\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y1\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y2\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"g\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"1\",\"2\":\"7\",\"3\":\"8\",\"4\":\"A\"},{\"1\":\"2\",\"2\":\"7\",\"3\":\"7\",\"4\":\"A\"},{\"1\":\"3\",\"2\":\"4\",\"3\":\"9\",\"4\":\"A\"},{\"1\":\"4\",\"2\":\"7\",\"3\":\"4\",\"4\":\"A\"},{\"1\":\"5\",\"2\":\"6\",\"3\":\"7\",\"4\":\"A\"},{\"1\":\"6\",\"2\":\"5\",\"3\":\"4\",\"4\":\"A\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\nWir berechnen `d`:\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-35_794525daf0dacc95650276af6a20d449'}\n\n```{.r .cell-code}\nd_within <-\n  d_within %>% \n  mutate(d = y1 - y2)\n\nhead(d_within)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"id\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y1\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y2\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"g\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"d\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"7\",\"3\":\"8\",\"4\":\"A\",\"5\":\"-1\"},{\"1\":\"2\",\"2\":\"7\",\"3\":\"7\",\"4\":\"A\",\"5\":\"0\"},{\"1\":\"3\",\"2\":\"4\",\"3\":\"9\",\"4\":\"A\",\"5\":\"-5\"},{\"1\":\"4\",\"2\":\"7\",\"3\":\"4\",\"4\":\"A\",\"5\":\"3\"},{\"1\":\"5\",\"2\":\"6\",\"3\":\"7\",\"4\":\"A\",\"5\":\"-1\"},{\"1\":\"6\",\"2\":\"5\",\"3\":\"4\",\"4\":\"A\",\"5\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-36_8df256cc5130561c2101afe61e120666'}\n\n```{.r .cell-code}\nggbetweenstats(\n  d_within,\n  x = g,\n  y = d,\n  results.subtitle = FALSE\n)\n```\n\n::: {.cell-output-display}\n![](900-Modellieren_files/figure-html/unnamed-chunk-36-1.png){width=672}\n:::\n:::\n\n\nEs gibt einen gewissen Unterschied zwischen den Bedingungen;\ndie Reihenfolge k√∂nnte einen Einfluss haben.\nAber wir m√ºssen inferenzstatistisch pr√ºfen, wie gro√ü der Einfluss ist.\n\n\n\n#### Inferenzanalyse\n\n\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-37_ba5dc9c30033880784ddf86d7a25f80c'}\n\n```{.r .cell-code}\nm_within2 <- stan_glm(d ~ g, data = d_within, refresh = 0)\nparameters(m_within2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Parameter\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Median\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_low\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_high\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"pd\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Rhat\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"ESS\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Prior_Distribution\"],\"name\":[9],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Prior_Location\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Prior_Scale\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"(Intercept)\",\"2\":\"-1.1382200\",\"3\":\"0.95\",\"4\":\"-2.349541\",\"5\":\"0.1188616\",\"6\":\"0.96525\",\"7\":\"0.9992157\",\"8\":\"3740.259\",\"9\":\"normal\",\"10\":\"-1.6\",\"11\":\"6.573061\"},{\"1\":\"gB\",\"2\":\"-0.9197517\",\"3\":\"0.95\",\"4\":\"-2.661213\",\"5\":\"0.7763573\",\"6\":\"0.87250\",\"7\":\"0.9996207\",\"8\":\"3827.215\",\"9\":\"normal\",\"10\":\"0.0\",\"11\":\"12.980755\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nDas CI f√ºr die Reihenfolge (Variable `gB`) beinhaltet die Null nicht;\nder Koeffizient `pd` gibt knapp 90% Wahrscheinlichkeit f√ºr einen (negativen Effekt) an.\nDamit haben wir einige Evidenz f√ºr einen Reihenfolgeneffekt.\n\nDer Effekt f√ºr `d` (`(Intercept)`) zeigt ein Intervall, das die Null nicht enth√§lt.\nDaher haben wir auch hier wieder Evidenz gegen die Nullhypothese.\n\n\n\n### 1 within-Variable mit mehr als zwei Stufen\n\n\n{{< fa dumbbell >}} VERTIEFUNG {{< fa dumbbell >}}\n\n\n\n\n#### Deskriptive Analyse\n\nHier sind einige Spieldaten:\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-38_25384f937ce941123e3ba791fc28af63'}\n\n```{.r .cell-code}\nd_within <- \n  read_csv(\"https://raw.githubusercontent.com/sebastiansauer/Lehre/main/data/withindesign.csv\")\n\nhead(d_within)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"id\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y1\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y2\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y3\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"g\"],\"name\":[5],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"1\",\"2\":\"7\",\"3\":\"8\",\"4\":\"9\",\"5\":\"A\"},{\"1\":\"2\",\"2\":\"7\",\"3\":\"7\",\"4\":\"10\",\"5\":\"A\"},{\"1\":\"3\",\"2\":\"4\",\"3\":\"9\",\"4\":\"9\",\"5\":\"A\"},{\"1\":\"4\",\"2\":\"7\",\"3\":\"4\",\"4\":\"9\",\"5\":\"A\"},{\"1\":\"5\",\"2\":\"6\",\"3\":\"7\",\"4\":\"8\",\"5\":\"A\"},{\"1\":\"6\",\"2\":\"5\",\"3\":\"4\",\"4\":\"9\",\"5\":\"A\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nHier ben√∂tigen wir die Daten in Langform:\n\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-39_50c4b3185ebcdf23411d036ebaf09c19'}\n\n```{.r .cell-code}\nd_long <-\n  d_within %>% \n  pivot_longer(cols = y1:y3, names_to = \"time\", values_to = \"y\")\n\nhead(d_long)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"id\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"g\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"time\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"y\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"A\",\"3\":\"y1\",\"4\":\"7\"},{\"1\":\"1\",\"2\":\"A\",\"3\":\"y2\",\"4\":\"8\"},{\"1\":\"1\",\"2\":\"A\",\"3\":\"y3\",\"4\":\"9\"},{\"1\":\"2\",\"2\":\"A\",\"3\":\"y1\",\"4\":\"7\"},{\"1\":\"2\",\"2\":\"A\",\"3\":\"y2\",\"4\":\"7\"},{\"1\":\"2\",\"2\":\"A\",\"3\":\"y3\",\"4\":\"10\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n#### Inferenzanalyse\n\n\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-40_52c343cde09a9b93557396bf698a1b24'}\n\n```{.r .cell-code}\nm_within3 <- stan_lmer(y ~ 1 + (1 | time), data = d_long, refresh = 0)\nsummary(m_within3)\n## \n## Model Info:\n##  function:     stan_lmer\n##  family:       gaussian [identity]\n##  formula:      y ~ 1 + (1 | time)\n##  algorithm:    sampling\n##  sample:       4000 (posterior sample size)\n##  priors:       see help('prior_summary')\n##  observations: 120\n##  groups:       time (3)\n## \n## Estimates:\n##                                       mean   sd   10%   50%   90%\n## (Intercept)                          7.2    1.3  5.7   7.1   8.7 \n## b[(Intercept) time:y1]              -1.7    1.3 -3.2  -1.6  -0.2 \n## b[(Intercept) time:y2]              -0.1    1.3 -1.6  -0.1   1.3 \n## b[(Intercept) time:y3]               1.8    1.3  0.3   1.8   3.2 \n## sigma                                1.5    0.1  1.3   1.4   1.6 \n## Sigma[time:(Intercept),(Intercept)]  4.9    5.3  1.2   3.1  10.5 \n## \n## Fit Diagnostics:\n##            mean   sd   10%   50%   90%\n## mean_PPD 7.2    0.2  6.9   7.2   7.4  \n## \n## The mean_ppd is the sample average posterior predictive distribution of the outcome variable (for details see help('summary.stanreg')).\n## \n## MCMC diagnostics\n##                                     mcse Rhat n_eff\n## (Intercept)                         0.0  1.0  1128 \n## b[(Intercept) time:y1]              0.0  1.0  1156 \n## b[(Intercept) time:y2]              0.0  1.0  1161 \n## b[(Intercept) time:y3]              0.0  1.0  1140 \n## sigma                               0.0  1.0  2728 \n## Sigma[time:(Intercept),(Intercept)] 0.1  1.0  1678 \n## mean_PPD                            0.0  1.0  4029 \n## log-posterior                       0.1  1.0  1287 \n## \n## For each parameter, mcse is Monte Carlo standard error, n_eff is a crude measure of effective sample size, and Rhat is the potential scale reduction factor on split chains (at convergence Rhat=1).\n```\n:::\n\n\nNur die festen (fixed) Effekte kann man sich so ausgeben lassen:\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-41_a393902a0218a3273e92af761b57aa74'}\n\n```{.r .cell-code}\nfixef(m_within3)\n## (Intercept) \n##     7.12602\n```\n:::\n\n\n\nIm Durchschnitt werden ca. 7.1 Fragen richtig beantwortet (Gesamtmittel).\n\n\nNur die Random-Effekte kann man sich so ausgeben lassen:\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-42_65ceda803c4cb146c0192c5756064af7'}\n\n```{.r .cell-code}\nranef(m_within3)\n## $time\n##    (Intercept)\n## y1 -1.62693012\n## y2 -0.08511958\n## y3  1.78086376\n## \n## with conditional variances for \"time\"\n```\n:::\n\n\nDas sind jeweils die Abweichungen der Gruppenmittelwerte (y1, y2, y3) vom Gesamtmittel.\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-43_7408c9d769a0ad569dc1fe7e031d63be'}\n\n```{.r .cell-code}\nplot(m_within3)\n```\n\n::: {.cell-output-display}\n![](900-Modellieren_files/figure-html/unnamed-chunk-43-1.png){width=672}\n:::\n:::\n\n\n\n\n## Aufgaben\n\n\nS. bei [Datenwerk]() die Aufgaben mit dem Tag [research-question](https://datenwerk.netlify.app/#category=research-question) und [researchdesign](https://datenwerk.netlify.app/#category=researchdesign)\n\n\n- [within-design-analysis1](https://datenwerk.netlify.app/posts/within-design-analysis1/within-design-analysis1.html)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}