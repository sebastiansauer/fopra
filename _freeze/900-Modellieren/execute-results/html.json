{
  "hash": "f34b51c183e316fafd31acef46f571ab",
  "result": {
    "markdown": "# Auswerten: Modellieren\n\n\n\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-2_3b2744316729f1633db6fef434f8d965'}\n\n:::\n\n\n## Lernsteuerung\n\n\n### Lernziele\n\n\n- Sie können die Modellformel Ihrer Forschungsfrage nennen.\n- Sie können Ihre Modellformel (korrekt) in R spezifizieren.\n\n\n### Benötigte R-Pakete\n\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-3_5550c38e2557d76bae533dd1f291823c'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(easystats)\nlibrary(ggstatsplot)\nlibrary(rstanarm)\n```\n:::\n\n\n\n\n### Position im Lernpfad\n\nSie befinden sich im Abschnitt \"Auswerten\" in @fig-ueberblick.\n\n\n\n\n\n\n## Metrische AV, between-Design\n\n\nGängige Forschungsfragen dieser Art sind [hier](https://start-bayes.netlify.app/metrische-av) erläutert.\n\n\n\n## Metrische AV, within-Design\n\n\n### 1 within-Variable\n\n\nEine Studie mit Vorher-Nachher-Messung setzt ein Within-Design um.\n\n\n:::{#exm-within1}\n### Statisches Diagramm vs. animiertes Diagramm\nEin Forschungsteam untersuch den Effekt der UV *Diagrammart* `D` (mit den zwei Stufen `D.1` *animiert* und `D.2` *statisch*) auf die Behaltensleistung (`y`) von Probanden.\nNach jeder Bedingung wird die Behaltensleistung gemessen (anhand von 10 Wissensfragen, die jeweils als \"richtig\" oder \"falsch\" bewertet wurden), mit `y1` nach `D.1` und `y2` für `D.2`.\n:::\n\n\n\n#### Design\n\n\nForschungsfrage:\n\n>    Hat die Diagrammart einen Einfluss auf die Behaltensleistung? Anders gesagt: Unterscheiden sich die Diagrammarten in ihrem Einfluss auf die Behaltensleistung?\n\n\nDie zugehörige Hypothese kann man so formulieren: $d \\ne 0$, wobei $d = y_1 - y_2$.\n\nDie Modellformel lautet: `d ~ 1`,\ndas ist ein *Interceptmodell*, also ein Modell ohne Prädiktor. \nUns interessiert, ob die Variable `d` im Mittelwert ungleich Null ist.\n\n\n```{mermaid}\nflowchart LR\n  D.1 --> y1 --> D.2 --> y2\n```\n\n\n\n#### Deskriptive Analyse\n\nHier sind einige Spieldaten:\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-5_de7a84ecaeeaeda64d11eff5c7750c2a'}\n\n```{.r .cell-code}\nd_within <- \n  read_csv(\"https://raw.githubusercontent.com/sebastiansauer/Lehre/main/data/withindesign.csv\") %>% \n  select(-c(y3, g)) # diese beiden Variablen ignorieren wir für den Augenblick\n\nhead(d_within)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"id\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y1\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y2\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"7\",\"3\":\"8\"},{\"1\":\"2\",\"2\":\"7\",\"3\":\"7\"},{\"1\":\"3\",\"2\":\"4\",\"3\":\"9\"},{\"1\":\"4\",\"2\":\"7\",\"3\":\"4\"},{\"1\":\"5\",\"2\":\"6\",\"3\":\"7\"},{\"1\":\"6\",\"2\":\"5\",\"3\":\"4\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\nWir berechnen `d`:\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-6_58c351f98ea8590573c98c328cdab9c6'}\n\n```{.r .cell-code}\nd_within <-\n  d_within %>% \n  mutate(d = y1 - y2)\n\nhead(d_within)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"id\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y1\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y2\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"d\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"7\",\"3\":\"8\",\"4\":\"-1\"},{\"1\":\"2\",\"2\":\"7\",\"3\":\"7\",\"4\":\"0\"},{\"1\":\"3\",\"2\":\"4\",\"3\":\"9\",\"4\":\"-5\"},{\"1\":\"4\",\"2\":\"7\",\"3\":\"4\",\"4\":\"3\"},{\"1\":\"5\",\"2\":\"6\",\"3\":\"7\",\"4\":\"-1\"},{\"1\":\"6\",\"2\":\"5\",\"3\":\"4\",\"4\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-7_bc128bf002666ac237dfd915d748c3e3'}\n\n```{.r .cell-code}\ngghistostats(d_within,\n             x = d,\n             results.subtitle = FALSE  # verzichte auf zusätzliche Statistiken\n             )\n```\n\n::: {.cell-output-display}\n![](900-Modellieren_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nDa `d` im Mittel negativ ist, ist der Mittelwert von `y2` höher als der von `y1`.\n\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-8_91eb8decd6346073188576327097b7fe'}\n\n```{.r .cell-code}\nd_within %>% \n  describe_distribution(d)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Variable\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Mean\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SD\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"IQR\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Min\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Max\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Skewness\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Kurtosis\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"n\"],\"name\":[9],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"n_Missing\"],\"name\":[10],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"d\",\"2\":\"-1.6\",\"3\":\"2.629224\",\"4\":\"4\",\"5\":\"-9\",\"6\":\"3\",\"7\":\"-0.5495719\",\"8\":\"0.3047316\",\"9\":\"40\",\"10\":\"0\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\nUm die Daten noch anders  visualisieren zu können, formen wir sie ins \"lange Format\" um.\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-9_e19a5be9a8a5526390e8e80ef4463de1'}\n\n```{.r .cell-code}\nd_long <-\n  d_within %>% \n  pivot_longer(cols = c(y1, y2), names_to = \"time\", values_to = \"y\")\n\nhead(d_long)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"id\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"d\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"time\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"y\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"-1\",\"3\":\"y1\",\"4\":\"7\"},{\"1\":\"1\",\"2\":\"-1\",\"3\":\"y2\",\"4\":\"8\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"y1\",\"4\":\"7\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"y2\",\"4\":\"7\"},{\"1\":\"3\",\"2\":\"-5\",\"3\":\"y1\",\"4\":\"4\"},{\"1\":\"3\",\"2\":\"-5\",\"3\":\"y2\",\"4\":\"9\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\nVisualisieren wir uns die Daten:\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-10_7d72cd2f1719cd5ef1ee5a79ae36a15e'}\n\n```{.r .cell-code}\nggwithinstats(\n  data = d_long,\n  x = time,\n  y = y,\n  results.subtitle = FALSE  # verzichte auf zusätzliche Statistiken\n)\n```\n\n::: {.cell-output-display}\n![](900-Modellieren_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n#### Inferenzanalyse\n\nWir berechnen das Modell:\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-11_8358ad57a627595931fab9bb3e6b2785'}\n\n```{.r .cell-code}\nm1 <- stan_glm(d ~ 1, data = d_within, refresh = 0)\nparameters(m1)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Parameter\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Median\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_low\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_high\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"pd\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Rhat\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"ESS\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Prior_Distribution\"],\"name\":[9],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Prior_Location\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Prior_Scale\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"(Intercept)\",\"2\":\"-1.582797\",\"3\":\"0.95\",\"4\":\"-2.398827\",\"5\":\"-0.7126228\",\"6\":\"0.99975\",\"7\":\"1.001197\",\"8\":\"2342.595\",\"9\":\"normal\",\"10\":\"-1.6\",\"11\":\"6.573061\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nHier ist eine Visualisierung des 95%-ETI des Unterschieds (`d`) zwischen den Bedingungen:\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-12_259698e7a6f2bbda3c3bfc8beaf32ea0'}\n\n```{.r .cell-code}\nparameters(m1) %>% plot(show_intercept = TRUE)\n```\n\n::: {.cell-output-display}\n![](900-Modellieren_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n\n### 1 within-Variable, 1 between-Variable\n\n\n\n\n>    Hat die Diagrammart einen Einfluss auf die Behaltensleistung? Anders gesagt: Unterscheiden sich die Diagrammarten in ihrem Einfluss auf die Behaltensleistung? Dabei kontrollieren wir die Reihenfolge.\n\n\nDie zugehörige Hypothese kann man so formulieren: $d \\ne 0$, wobei $d = y_1 - y_2$.\n\nDie Modellformel lautet: `d ~ 1 + g`.\nDas kann man synonym so schreiben: `d ~ g`.\nUns interessiert, ob die Variable `d` im Mittelwert ungleich Null ist.\n\n\n\n\n```{mermaid}\nflowchart LR\n  subgraph g2\n    direction LR\n    D.1 --> y1 --> D.2 --> y2\n  end\n  subgraph g1\n    direction LR\n    D2[D.2] --> y22[y2] --> D1[D.1] --> y11[y1] \n  end\n```\n\n\n\n#### Deskriptive Analyse\n\nHier sind einige Spieldaten:\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-14_3b83b2afd91442988d567bbf02089378'}\n\n```{.r .cell-code}\nd_within <- \n  read_csv(\"https://raw.githubusercontent.com/sebastiansauer/Lehre/main/data/withindesign.csv\") %>% \n  select(-c(y3)) # die  Variable `y3` ignorieren wir für den Augenblick\n\nhead(d_within)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"id\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y1\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y2\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"g\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"1\",\"2\":\"7\",\"3\":\"8\",\"4\":\"A\"},{\"1\":\"2\",\"2\":\"7\",\"3\":\"7\",\"4\":\"A\"},{\"1\":\"3\",\"2\":\"4\",\"3\":\"9\",\"4\":\"A\"},{\"1\":\"4\",\"2\":\"7\",\"3\":\"4\",\"4\":\"A\"},{\"1\":\"5\",\"2\":\"6\",\"3\":\"7\",\"4\":\"A\"},{\"1\":\"6\",\"2\":\"5\",\"3\":\"4\",\"4\":\"A\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\nWir berechnen `d`:\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-15_ee168d895635abf004e3d344b1716826'}\n\n```{.r .cell-code}\nd_within <-\n  d_within %>% \n  mutate(d = y1 - y2)\n\nhead(d_within)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"id\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y1\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y2\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"g\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"d\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"7\",\"3\":\"8\",\"4\":\"A\",\"5\":\"-1\"},{\"1\":\"2\",\"2\":\"7\",\"3\":\"7\",\"4\":\"A\",\"5\":\"0\"},{\"1\":\"3\",\"2\":\"4\",\"3\":\"9\",\"4\":\"A\",\"5\":\"-5\"},{\"1\":\"4\",\"2\":\"7\",\"3\":\"4\",\"4\":\"A\",\"5\":\"3\"},{\"1\":\"5\",\"2\":\"6\",\"3\":\"7\",\"4\":\"A\",\"5\":\"-1\"},{\"1\":\"6\",\"2\":\"5\",\"3\":\"4\",\"4\":\"A\",\"5\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-16_85df78643832df5eca135b4c122828b2'}\n\n```{.r .cell-code}\nggbetweenstats(\n  d_within,\n  x = g,\n  y = d,\n  results.subtitle = FALSE\n)\n```\n\n::: {.cell-output-display}\n![](900-Modellieren_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\nEs gibt einen gewissen Unterschied zwischen den Bedingungen;\ndie Reihenfolge könnte einen Einfluss haben.\nAber wir müssen inferenzstatistisch prüfen, wie groß der Einfluss ist.\n\n\n\n#### Inferenzanalyse\n\n\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-17_bede0e4ba8245d79a3024b8ae5599c9c'}\n\n```{.r .cell-code}\nm2 <- stan_glm(d ~ g, data = d_within, refresh = 0)\nparameters(m2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Parameter\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Median\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_low\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"CI_high\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"pd\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Rhat\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"ESS\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Prior_Distribution\"],\"name\":[9],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Prior_Location\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Prior_Scale\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"(Intercept)\",\"2\":\"-1.1623942\",\"3\":\"0.95\",\"4\":\"-2.370073\",\"5\":\"-0.03974313\",\"6\":\"0.97775\",\"7\":\"0.9999806\",\"8\":\"3577.467\",\"9\":\"normal\",\"10\":\"-1.6\",\"11\":\"6.573061\"},{\"1\":\"gB\",\"2\":\"-0.8999453\",\"3\":\"0.95\",\"4\":\"-2.527106\",\"5\":\"0.77386263\",\"6\":\"0.86050\",\"7\":\"1.0003083\",\"8\":\"3609.558\",\"9\":\"normal\",\"10\":\"0.0\",\"11\":\"12.980755\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nDas CI für die Reihenfolge (Variable `gB`) beinhaltet die Null nicht;\nder Koeffizient `pd` gibt knapp 90% Wahrscheinlichkeit für einen (negativen Effekt) an.\nDamit haben wir einige Evidenz für einen Reihenfolgeneffekt.\n\nDer Effekt für `d` (`(Intercept)`) zeigt ein Intervall, das die Null nicht enthält.\nDaher haben wir auch hier wieder Evidenz gegen die Nullhypothese.\n\n\n\n### 1 within-Variable mit mehr als zwei Stufen\n\n\n{{< fa dumbbell >}} VERTIEFUNG {{< fa dumbbell >}}\n\n\n\n\n#### Deskriptive Analyse\n\nHier sind einige Spieldaten:\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-18_8726287353baae0cc7a74af014d5630a'}\n\n```{.r .cell-code}\nd_within <- \n  read_csv(\"https://raw.githubusercontent.com/sebastiansauer/Lehre/main/data/withindesign.csv\")\n\nhead(d_within)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"id\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y1\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y2\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y3\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"g\"],\"name\":[5],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"1\",\"2\":\"7\",\"3\":\"8\",\"4\":\"9\",\"5\":\"A\"},{\"1\":\"2\",\"2\":\"7\",\"3\":\"7\",\"4\":\"10\",\"5\":\"A\"},{\"1\":\"3\",\"2\":\"4\",\"3\":\"9\",\"4\":\"9\",\"5\":\"A\"},{\"1\":\"4\",\"2\":\"7\",\"3\":\"4\",\"4\":\"9\",\"5\":\"A\"},{\"1\":\"5\",\"2\":\"6\",\"3\":\"7\",\"4\":\"8\",\"5\":\"A\"},{\"1\":\"6\",\"2\":\"5\",\"3\":\"4\",\"4\":\"9\",\"5\":\"A\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nHier benötigen wir die Daten in Langform:\n\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-19_075d7d2f36c6dda450a559f6d6eca114'}\n\n```{.r .cell-code}\nd_long <-\n  d_within %>% \n  pivot_longer(cols = y1:y3, names_to = \"time\", values_to = \"y\")\n\nhead(d_long)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"id\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"g\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"time\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"y\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"A\",\"3\":\"y1\",\"4\":\"7\"},{\"1\":\"1\",\"2\":\"A\",\"3\":\"y2\",\"4\":\"8\"},{\"1\":\"1\",\"2\":\"A\",\"3\":\"y3\",\"4\":\"9\"},{\"1\":\"2\",\"2\":\"A\",\"3\":\"y1\",\"4\":\"7\"},{\"1\":\"2\",\"2\":\"A\",\"3\":\"y2\",\"4\":\"7\"},{\"1\":\"2\",\"2\":\"A\",\"3\":\"y3\",\"4\":\"10\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n#### Inferenzanalyse\n\n\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-20_e8913fbb356795ce9e28d1f0a1c13d7c'}\n\n```{.r .cell-code}\nm3 <- stan_lmer(y ~ 1 + (1 | time), data = d_long, refresh = 0)\nsummary(m3)\n## \n## Model Info:\n##  function:     stan_lmer\n##  family:       gaussian [identity]\n##  formula:      y ~ 1 + (1 | time)\n##  algorithm:    sampling\n##  sample:       4000 (posterior sample size)\n##  priors:       see help('prior_summary')\n##  observations: 120\n##  groups:       time (3)\n## \n## Estimates:\n##                                       mean   sd   10%   50%   90%\n## (Intercept)                          7.1    1.2  5.7   7.2   8.5 \n## b[(Intercept) time:y1]              -1.6    1.2 -3.0  -1.6  -0.3 \n## b[(Intercept) time:y2]              -0.1    1.2 -1.4  -0.1   1.3 \n## b[(Intercept) time:y3]               1.8    1.2  0.4   1.8   3.2 \n## sigma                                1.5    0.1  1.3   1.4   1.6 \n## Sigma[time:(Intercept),(Intercept)]  4.8    5.2  1.1   3.1   9.9 \n## \n## Fit Diagnostics:\n##            mean   sd   10%   50%   90%\n## mean_PPD 7.2    0.2  6.9   7.2   7.4  \n## \n## The mean_ppd is the sample average posterior predictive distribution of the outcome variable (for details see help('summary.stanreg')).\n## \n## MCMC diagnostics\n##                                     mcse Rhat n_eff\n## (Intercept)                         0.0  1.0  1008 \n## b[(Intercept) time:y1]              0.0  1.0  1040 \n## b[(Intercept) time:y2]              0.0  1.0  1014 \n## b[(Intercept) time:y3]              0.0  1.0  1003 \n## sigma                               0.0  1.0  2929 \n## Sigma[time:(Intercept),(Intercept)] 0.1  1.0  1346 \n## mean_PPD                            0.0  1.0  3682 \n## log-posterior                       0.1  1.0  1222 \n## \n## For each parameter, mcse is Monte Carlo standard error, n_eff is a crude measure of effective sample size, and Rhat is the potential scale reduction factor on split chains (at convergence Rhat=1).\n```\n:::\n\n\nNur die festen (fixed) Effekte kann man sich so ausgeben lassen:\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-21_7761dd5515d9e7011b41b8168f6d2e69'}\n\n```{.r .cell-code}\nfixef(m3)\n## (Intercept) \n##    7.156988\n```\n:::\n\n\n\nIm Durchschnitt werden ca. 7.1 Fragen richtig beantwortet (Gesamtmittel).\n\n\nNur die Random-Effekte kann man sich so ausgeben lassen:\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-22_40809aac2123eae7536a639b6f2ed238'}\n\n```{.r .cell-code}\nranef(m3)\n## $time\n##    (Intercept)\n## y1 -1.63496890\n## y2 -0.09323741\n## y3  1.78891295\n## \n## with conditional variances for \"time\"\n```\n:::\n\n\nDas sind jeweils die Abweichungen der Gruppenmittelwerte (y1, y2, y3) vom Gesamtmittel.\n\n\n::: {.cell hash='900-Modellieren_cache/html/unnamed-chunk-23_ac8f2919d452b2728344847fc40a1f5d'}\n\n```{.r .cell-code}\nplot(m3)\n```\n\n::: {.cell-output-display}\n![](900-Modellieren_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n\n\n## Aufgaben\n\n\nS. bei [Datenwerk]() die Aufgaben mit dem Tag [research-question](https://datenwerk.netlify.app/#category=research-question) und [researchdesign](https://datenwerk.netlify.app/#category=researchdesign)\n\n\n- [within-design-analysis1](https://datenwerk.netlify.app/posts/within-design-analysis1/within-design-analysis1.html)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}